import{r as _,I as P,J as S,K as l,M as o,N as a,D as e,G as t,O as f,P as v,k as R,b as F,V as T,Q as U,R as Z,F as x,Z as X}from"./@vue-DQPB5ixA.js";import{u as Y}from"./vue-router-CQQ818li.js";import{u as tt}from"./vue-i18n-D3aLYNeJ.js";import{u as W,f as k,M,o as at,t as b,d as ot,e as z,b as st,J as E,C as V,D as A,n as j,I as et,m as nt,r as it,p as lt,P as rt,j as dt,c as ct}from"./@ionic-BzoWLFGj.js";import{m as ut,c as wt,n as pt}from"./ionicons-DKP7Q_k0.js";import{i as q,u as ht,c as mt,m as ft,b as gt}from"./index-b0wqW7zq.js";import{g as _t,a as vt,c as bt}from"./withdraw-CpnP0UnC.js";import"./@intlify-BAcCFw_v.js";import"./@ionic_components_1-CAQXnsIn.js";import"./@stencil-C-gE1UvY.js";import"./@ionic_components_2-DUGZJZYA.js";import"./@capacitor-CHoHO2YB.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-CYwfShO_.js";import"./jsencrypt-Ve0Y4aUG.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const At={class:"wrapper"},kt={class:"dialog-title"},$t={class:"dialog-content"},yt={class:"btn-group"},Pt={__name:"SetPasswordPopup",setup(O,{expose:C}){const $=W(),{popupEnter:L,popupLeave:r}=q(),u=_(!1),g=async()=>{u.value=!0},I=()=>{u.value=!1,$.push({name:"WithdrawPassword"})};return C({showDialog:g}),(c,d)=>(P(),S(t(M),{class:"setPassword-popup",isOpen:u.value,enterAnimation:t(L),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[o("div",At,[o("h3",kt,a(c.$t("withdraw.setPasswordPopup.title")),1),o("div",$t,a(c.$t("withdraw.setPasswordPopup.des")),1),o("div",yt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(I,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.goToSetPassword")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},Ct={class:"wrapper"},Lt={class:"dialog-title"},It={class:"dialog-content"},Dt={class:"btn-group"},Nt={__name:"BankCardPopup",setup(O,{expose:C}){const $=W(),{popupEnter:L,popupLeave:r}=q(),u=_(!1),g=async()=>{u.value=!0},I=()=>{u.value=!1,$.push({name:"BankCardList"})};return C({showDialog:g}),(c,d)=>(P(),S(t(M),{class:"bankCard-popup",isOpen:u.value,enterAnimation:t(L),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[o("div",Ct,[o("h3",Lt,a(c.$t("withdraw.bankCardPopup.title")),1),o("div",It,a(c.$t("withdraw.bankCardPopup.des")),1),o("div",Dt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(I,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.addNewAccount")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},St={class:"balance-card"},Bt={class:"balance-content"},zt={class:"balance-title"},Vt={class:"balance-amount"},Wt={style:{margin:"4px 0"}},Mt={class:"block-title ion-justify-content-between",style:{display:"flex"}},Ot={key:1,class:"bank-info"},Rt={style:{margin:"4px 0"}},Ft={class:"block-title"},Tt=o("hr",null,null,-1),Ut={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Et={slot:"end"},jt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},qt={slot:"end"},Ht={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Jt={slot:"end"},Gt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Kt={slot:"end"},Qt=o("hr",null,null,-1),Zt={style:{margin:"4px 0"}},xt={class:"block-title"},Xt={style:{"font-size":"0.8rem"}},Yt={style:{color:"#ffdf3f","margin-left":"4px"}},ta={style:{color:"#ffdf3f","margin-left":"4px"}},aa={class:"account-number"},oa={class:"account-text"},sa=o("br",null,null,-1),ea={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},na={slot:"end"},ia={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},la={slot:"end"},ra={style:{"font-size":"0.8rem",color:"#fa8484"}},da={style:{color:"#ffdf3f",margin:"0 4px"}},ca={style:{margin:"4px 0"}},ua={class:"block-title"},wa={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},pa={slot:"end"},ha={class:"block-title"},Ma={__name:"Withdraw",setup(O){const C=Y(),{t:$}=tt(),L=W(),r=ht();mt();const{getPublicUrl:u}=gt(),g=_(null),I=_(null),c=_(!1),d=_(!1),D=_([]),m="â‚¹",y=_(0),N=_(0),n=R({withdrawAmount:0,remainingWithdrawLimit:"",remainingWithdrawCount:"",withdrawLimit:"",vipDailyLimit:"",balance:"",withdrawAccount:{},withdrawAccounts:[]}),w=R({withdrawAmount:0,withdrawFee:0,arrivalAmount:0,bankAccount:"",serviceCharge:0,withdrawPassword:""});at(async()=>{r.barLoading=!0;const s=await _t();if(s.code==="00000")if(n.withdrawAccounts=s.data,C.query.cardId){const i=n.withdrawAccounts.filter(B=>B.id==C.query.cardId);n.withdrawAccount=i.length>0?i[0]:n.withdrawAccounts[0]}else n.withdrawAccount=n.withdrawAccounts[0];else await(await b.create({message:bankData.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const p=await ft();p.code==="00000"?(d.value=!!p.data.withdrawPasswordValid,d.value||g.value.showDialog()):await(await b.create({message:p.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const h=await vt();h.code==="00000"?(N.value=r.appConfig.maxWithdrawAmount,y.value=r.appConfig.minWithdrawAmount,D.value=[y.value],n.vipDailyLimit=h.data.vipDailyAmountLimit,n.withdrawLimit=h.data.withdrawLimit,n.balance=h.data.balance,n.withdrawAmount=y.value):await(await b.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.barLoading=!1});const H=s=>{n.withdrawAmount=Number(s)},J=()=>{d.value?L.push({name:"BankCardList"}):g.value.showDialog()},G=()=>{d.value?L.push({name:"BankCardList"}):g.value.showDialog()},K=async()=>{if(!d.value){g.value.showDialog();return}if(n.withdrawAccounts.length==0){I.value.showDialog();return}if(Number(n.withdrawAmount)<=0){await(await b.create({message:$("withdraw.toast.text3"),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}if(Number(n.withdrawAmount)<y.value||Number(n.withdrawAmount)>N.value){await(await b.create({message:"Min: ".concat(y.value," Max: ").concat(N.value),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}r.fullLoading=!0,w.arrivalAmount=n.withdrawAmount,w.bankAccount=n.withdrawAccount.cardNo,w.withdrawAmount=n.withdrawAmount,w.withdrawPassword="",c.value=!0,r.fullLoading=!1},Q=async()=>{if(w.withdrawPassword.length==0){await(await b.create({message:$("withdraw.toast.text1"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}r.fullLoading=!0;const s=await bt({amount:Number(n.withdrawAmount),id:n.withdrawAccount.id,memberBankId:n.withdrawAccount.bankId,memberBankCardNo:r.encrypt.encrypt(n.withdrawAccount.cardNo),withdrawPassword:r.encrypt.encrypt(w.withdrawPassword)});s.code==="00000"?(await(await b.create({message:$("withdraw.toast.text2"),duration:1500,position:"top",color:"success",translucent:!0})).present(),c.value=!1):await(await b.create({message:s.msg||s.code,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.fullLoading=!1};return(s,p)=>F((P(),S(t(dt),{class:"withdraw"},{default:l(()=>[e(t(j),null,{default:l(()=>{var h;return[o("div",St,[e(t(ot),{src:t(u)("/wallet/img-bg-balance.png")},null,8,["src"]),o("div",Bt,[o("div",zt,a(s.$t("withdraw.myBalance")),1),o("div",Vt,a(t(m))+" "+a((h=n.balance)==null?void 0:h.toLocaleString()),1)])]),o("div",Wt,[o("div",Mt,[o("span",null,a(s.$t("withdraw.bankAccount")),1),o("span",{class:"btn-change-account",onClick:f(G,["stop"])},a(s.$t("withdraw.changeBankAccount")),1)]),n.withdrawAccounts.length==0?(P(),S(t(k),{key:0,class:"btn-add-account",expand:"block",onClick:f(J,["stop"])},{default:l(()=>[e(t(z),{slot:"start",icon:t(ut)},null,8,["icon"]),o("span",null,a(s.$t("withdraw.addNewAccount")),1)]),_:1})):(P(),U("div",Ot,"Acc No: "+a(n.withdrawAccount.cardNo),1))]),o("div",Rt,[o("div",Ft,[v(a(s.$t("withdraw.withdrawAmount"))+" ",1),o("span",null,"("+a(t(m))+" "+a(y.value)+" - "+a(N.value)+" )",1)]),e(t(st),{style:{margin:"8px 0"}},{default:l(()=>[(P(!0),U(x,null,Z(D.value,(i,B)=>(P(),S(t(ct),{key:B,size:"3.8",class:X(["amount-item",{select:Number(i)==Number(n.withdrawAmount)}]),onClick:f(ma=>H(i),["stop"])},{default:l(()=>[o("div",null,a(t(m))+" "+a(i==null?void 0:i.toLocaleString()),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),e(t(E),{modelValue:n.withdrawAmount,"onUpdate:modelValue":p[0]||(p[0]=i=>n.withdrawAmount=i),label:t(m),type:"number",placeholder:s.$t("withdraw.withdrawAmount"),max:N.value,min:y.value,clearInput:!0},null,8,["modelValue","label","placeholder","max","min"])]),Tt,e(t(V),null,{default:l(()=>[e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var i;return[o("span",Ut,a(s.$t("withdraw.items1"))+":",1),o("span",Et,a(t(m))+" "+a(((i=n.remainingWithdrawLimit)==null?void 0:i.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var i;return[o("span",jt,a(s.$t("withdraw.items2"))+":",1),o("span",qt,a(t(m))+" "+a(((i=n.vipDailyLimit)==null?void 0:i.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var i;return[o("span",Ht,a(s.$t("withdraw.items3"))+":",1),o("span",Jt,a(t(m))+" "+a(((i=n.withdrawLimit)==null?void 0:i.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var i;return[o("span",Gt,a(s.$t("withdraw.items4"))+":",1),o("span",Kt,a(((i=n.remainingWithdrawCount)==null?void 0:i.toLocaleString())||"-"),1)]}),_:1})]),_:1}),Qt,o("div",Zt,[o("div",xt,a(s.$t("withdraw.tips.title"))+": ",1),o("span",Xt,[o("span",null,a(s.$t("withdraw.tips.tips1")),1),o("span",Yt,a(s.$t("withdraw.tips.tips2")),1),o("span",null,a(s.$t("withdraw.tips.tips3")),1),o("span",ta,a(s.$t("withdraw.tips.tips4")),1),v(". ")])]),F(e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(K,["stop"])},{default:l(()=>[v(a(s.$t("withdraw.button.withdraw")),1)]),_:1},512),[[T,n.withdrawAmount]])]}),_:1}),e(Pt,{ref_key:"setPasswordPopup",ref:g},null,512),e(Nt,{ref_key:"bankCardPopup",ref:I},null,512),e(t(M),{class:"withdraw-info","is-open":c.value,"initial-breakpoint":1,breakpoints:[0,1]},{default:l(()=>[e(t(et),null,{default:l(()=>[e(t(nt),null,{default:l(()=>[e(t(it),null,{default:l(()=>[v(a(s.$t("withdraw.configPopup.title")),1)]),_:1}),e(t(lt),{style:{position:"absolute",top:"0",right:"16px"}},{default:l(()=>[e(t(k),{onClick:p[1]||(p[1]=f(h=>c.value=!1,["stop"]))},{default:l(()=>[e(t(z),{slot:"icon-only",icon:t(wt),color:"light"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(t(j),{class:"ion-padding"},{default:l(()=>{var h;return[o("div",aa,a(t(m))+" "+a((h=w.arrivalAmount)==null?void 0:h.toLocaleString()),1),o("div",oa,a(s.$t("withdraw.configPopup.arrivalAmount")),1),sa,e(t(V),null,{default:l(()=>[e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var i;return[o("span",ea,a(s.$t("withdraw.configPopup.title"))+":",1),o("span",na,a(t(m))+" "+a((i=w.withdrawAmount)==null?void 0:i.toLocaleString()),1)]}),_:1}),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var i;return[o("span",ia,a(s.$t("withdraw.configPopup.serviceCharge"))+":",1),o("span",la,a(t(m))+" "+a((i=w.serviceCharge)==null?void 0:i.toLocaleString()),1)]}),_:1}),o("div",ra,[o("span",null,a(s.$t("withdraw.configPopup.des1")),1),o("span",da,a(w.withdrawFee)+"%",1),o("span",null,a(s.$t("withdraw.configPopup.des2")),1)]),o("div",ca,[o("div",ua,a(s.$t("withdraw.configPopup.chooseBankAccount")),1),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>[o("span",wa,a(s.$t("withdraw.configPopup.yourBankAccount"))+":",1),o("span",pa,a(w.bankAccount),1)]),_:1})])]),_:1}),e(t(V),{class:"password-info",lines:"none",style:{margin:"4px 0"}},{default:l(()=>[o("div",ha,a(s.$t("withdraw.configPopup.withdrawPassword")),1),e(t(A),null,{default:l(()=>[e(t(E),{modelValue:w.withdrawPassword,"onUpdate:modelValue":p[2]||(p[2]=i=>w.withdrawPassword=i),type:"password",fill:"outline",placeholder:s.$t("withdraw.configPopup.placeHolder")},{default:l(()=>[e(t(z),{slot:"start",icon:t(pt)},null,8,["icon"]),e(t(rt),{slot:"end",color:"medium"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(Q,["stop"])},{default:l(()=>[v(a(s.$t("withdraw.button.withdraw")),1)]),_:1})]}),_:1})]),_:1},8,["is-open"])]),_:1},512)),[[T,!t(r).barLoading]])}};export{Ma as default};
