import{r as b,c as $,I as w,J as s,E as e,H as f,a as j,U as F,C as o,O as S,P as D,Q as z,F as B,S as _,L as d,M as m,Y as V,N as I}from"./@vue-B0j_qcai.js";import{K as G,H,J as T,E as J,o as O,k as q,D as x,m as E,b as v,d as p,g as N,f as L}from"./@ionic-18nICBu3.js";import{g as A,h as U}from"./ionicons-CdrslGsx.js";import{r as y,u as K,b as Q}from"./index-CBAZMc4h.js";import{d as R}from"./pinia-Ds326xZN.js";import{_ as W}from"./NoData-BgeuwovY.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-BLYQmdkJ.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./jsencrypt-Ve0Y4aUG.js";import"./vue-i18n-DzMZFiEd.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";function Y(i){return y({url:"/app/member/h5/siteMsg",method:"GET",params:i})}function X(i){return y({url:"/app/member/h5/siteMsg/read",method:"POST",data:i})}function Z(i){return y({url:"/app/member/h5/siteMsg/del",method:"PUT",data:i})}function ee(i){return y({url:"/app/member/h5/announce",method:"GET",params:i})}const te=R("mail",()=>{const i=b([]),l=b([]),r=$(()=>i.value.some(c=>!c.readStatus));return{mailList:i,hasUnread:r,getMailList:async()=>{const c=await Y();c.code==="00000"&&(i.value=c.data.list||[],i.value.forEach(g=>g.showDetail=!1))},announceList:l,getAnnounceList:async()=>{const c=await ee();c.code==="00000"&&(l.value=c.data.list||[],l.value.forEach(g=>g.showDetail=!1))}}},{persistedState:{persist:!1}}),ae={style:{"font-size":"0.8rem"}},se={style:{"font-size":"1rem","font-weight":"800"}},oe={style:{"font-size":"0.8rem"}},ie={style:{"font-size":"1rem","font-weight":"800"}},ke={__name:"Mail",setup(i){const l=K(),r=te(),{getPublicUrl:k}=Q(),n=b("system"),c={system:"mailList",activities:"announceList"};G(async()=>{l.barLoading=!0,await r.getMailList(),l.barLoading=!1});const g=async()=>{n.value=="system"&&await r.getMailList(),n.value=="activities"&&await r.getAnnounceList()},C=async u=>{u.showDetail=!u.showDetail,mail.readStatus||(n.value=="system"&&X({id:u.detailId}),n.value=="activities"&&readAnnounce({id:u.mainId}))},P=async u=>{l.barLoading=!0;const h=await Z({mailId:u.detailId});h.code==="00000"?(await r.getMailList(),l.barLoading=!1,await(await toastController.create({message:t("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await toastController.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),l.barLoading=!1)};return(u,h)=>(f(),w(e(q),{class:"mail"},{default:s(()=>[j(o(e(O),null,{default:s(()=>[o(e(H),{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=a=>n.value=a),mode:"ios",onIonChange:g},{default:s(()=>[o(e(T),{value:"system"},{default:s(()=>[S("System Notices")]),_:1}),o(e(T),{value:"activities"},{default:s(()=>[S("Activities")]),_:1})]),_:1},8,["modelValue"]),e(l).barLoading||e(r)[c[n.value]].length==0?(f(),w(W,{key:0,class:"no-data",desc:u.$t("mail.message.nodata")},null,8,["desc"])):(f(),w(e(J),{key:1,style:{"margin-top":"16px"}},{default:s(()=>[n.value=="system"?(f(!0),D(B,{key:0},z(e(r).mailList,a=>(f(),w(e(x),{key:a.detailId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(E),{class:"mail-content"},{default:s(()=>[d("div",ae,m(a.gmtCreate||""),1),d("h4",se,m(a.msgTitle||""),1),d("div",{class:V(["mail-detail",{"show-all":a.showDetail}])},m(a.msgContent||""),3),o(e(v),{class:"ion-justify-content-end"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[o(e(N),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:I(M=>C(a),["stop"])},{default:s(()=>[d("span",null,m(a.showDetail?"hide":"Show all"),1),o(e(L),{icon:a.showDetail?e(A):e(U),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(v),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[_("",!0)]),_:1}),o(e(p),{size:"auto"},{default:s(()=>[o(e(L),{class:"btn-del",src:e(k)("/icon_userInfo/icon-delete.svg"),onClick:I(M=>P(a),["stop"])},null,8,["src","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):_("",!0),n.value=="activities"?(f(!0),D(B,{key:1},z(e(r).announceList,a=>(f(),w(e(x),{key:a.mainId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(E),{class:"mail-content"},{default:s(()=>[d("div",oe,m(a.startTime||""),1),d("h4",ie,m(a.title||""),1),d("div",{class:V(["mail-detail",{"show-all":a.showDetail}])},m(a.content||""),3),o(e(v),{class:"ion-justify-content-end"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[o(e(N),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:I(M=>C(a),["stop"])},{default:s(()=>[d("span",null,m(a.showDetail?"hide":"Show all"),1),o(e(L),{icon:u.mail.showDetail?e(A):e(U),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(v),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[_("",!0)]),_:1}),o(e(p),{size:"auto"})]),_:1})]),_:2},1024)]),_:2},1024))),128)):_("",!0)]),_:1}))]),_:1},512),[[F,!e(l).barLoading]])]),_:1}))}};export{ke as default};
