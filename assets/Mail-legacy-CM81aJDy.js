System.register(["./index-legacy-BizqwEaK.js","./NoData-legacy-B8VsJvGd.js"],(function(e,a){"use strict";var i,l,s,n,o,c,d,r,m,u,g,h,f,p,v,w,y,b,_,L,k,x,C,z,D,M,S,j,I,T,A,E,U,P,V,B,G;return{setters:[e=>{i=e.Z,l=e.aB,s=e.r,n=e.m,o=e.l,c=e.X,d=e.j,r=e.w,m=e.u,u=e.d,g=e.ak,h=e.al,f=e.f,p=e.T,v=e.U,w=e.B,y=e.M,b=e.e,_=e.i,L=e.F,k=e.a1,x=e.z,C=e.A,z=e.H,D=e.L,M=e.h,S=e.y,j=e.aC,I=e.q,T=e.s,A=e.v,E=e.K,U=e.J,P=e.af,V=e.ag,B=e.C},e=>{G=e._}],execute:function(){var a=document.createElement("style");a.textContent=".mail{background-color:var(--ion-background-color)}.mail ion-segment.ios{background-color:#323738;border-radius:12px}.mail .mail-item{position:relative;height:fit-content;margin-bottom:12px;border-radius:8px}.mail .mail-item .mail-content{position:relative;width:100%;height:fit-content;padding:12px 8px}.mail .mail-item .mail-content .mail-detail{color:#b3bec1;margin:8px 2px;text-align:justify;white-space:pre;overflow:hidden;max-height:4rem}.mail .mail-item .mail-content .mail-detail.show-all{max-height:fit-content}.mail .no-data{position:relative;top:10vh}.mail .btn-show-all{margin-left:auto}.mail .btn-show-all::part(native){padding:0}.mail .btn-view-more{--background: #464f50;--background-activated: #464f50;--border-radius: 8px;--color: rgb(36, 238, 137)}.mail .btn-del{font-size:1.4rem}\n",document.head.appendChild(a);const N=l("mail",(()=>{const e=s([]),a=s([]),t=n((()=>e.value.some((e=>!e.readStatus))));return{mailList:e,hasUnread:t,getMailList:async()=>{const a=await i({url:"/app/member/h5/siteMsg",method:"GET",params:t});var t;"00000"===a.code&&(e.value=a.data.list||[],e.value.forEach((e=>e.showDetail=!1)))},announceList:a,getAnnounceList:async()=>{const e=await i({url:"/app/member/h5/announce",method:"GET",params:t});var t;"00000"===e.code&&(a.value=e.data.list||[],a.value.forEach((e=>e.showDetail=!1)))}}}),{persistedState:{persist:!1}}),q={style:{"font-size":"0.8rem"}},F={style:{"font-size":"1rem","font-weight":"800"}},H={style:{"font-size":"0.8rem"}},J={style:{"font-size":"1rem","font-weight":"800"}};e("default",{__name:"Mail",setup(e){const a=o(),l=N(),{getPublicUrl:n}=B(),K=s("system"),O={system:"mailList",activities:"announceList"};c((async()=>{a.barLoading=!0,await l.getMailList(),a.barLoading=!1}));const X=async()=>{"system"==K.value&&await l.getMailList(),"activities"==K.value&&await l.getAnnounceList()},Z=async e=>{var a;e.showDetail=!e.showDetail,mail.readStatus||("system"==K.value&&(a={id:e.detailId},i({url:"/app/member/h5/siteMsg/read",method:"POST",data:a})),"activities"==K.value&&readAnnounce({id:e.mainId}))},$=async e=>{a.barLoading=!0;const s=await function(e){return i({url:"/app/member/h5/siteMsg/del",method:"PUT",data:e})}({mailId:e.detailId});if("00000"===s.code){await l.getMailList(),a.barLoading=!1;const e=await toastController.create({message:t("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0});await e.present()}else{const e=await toastController.create({message:s.msg,duration:1500,position:"top",color:"danger",translucent:!0});await e.present(),a.barLoading=!1}};return(e,t)=>(u(),d(m(C),{class:"mail"},{default:r((()=>[g(f(m(x),null,{default:r((()=>[f(m(p),{modelValue:K.value,"onUpdate:modelValue":t[0]||(t[0]=e=>K.value=e),mode:"ios",onIonChange:X},{default:r((()=>[f(m(v),{value:"system"},{default:r((()=>[w("System Notices")])),_:1}),f(m(v),{value:"activities"},{default:r((()=>[w("Activities")])),_:1})])),_:1},8,["modelValue"]),m(a).barLoading||0==m(l)[O[K.value]].length?(u(),d(G,{key:0,class:"no-data",desc:e.$t("mail.message.nodata")},null,8,["desc"])):(u(),d(m(y),{key:1,style:{"margin-top":"16px"}},{default:r((()=>["system"==K.value?(u(!0),b(L,{key:0},_(m(l).mailList,(e=>(u(),d(m(z),{key:e.detailId,class:"mail-item",lines:"none"},{default:r((()=>[f(m(D),{class:"mail-content"},{default:r((()=>[M("div",q,S(e.gmtCreate||""),1),M("h4",F,S(e.msgTitle||""),1),M("div",{class:j(["mail-detail",{"show-all":e.showDetail}])},S(e.msgContent||""),3),f(m(I),{class:"ion-justify-content-end"},{default:r((()=>[f(m(T),{size:"auto"},{default:r((()=>[f(m(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:E((a=>Z(e)),["stop"])},{default:r((()=>[M("span",null,S(e.showDetail?"hide":"Show all"),1),f(m(U),{icon:e.showDetail?m(P):m(V),style:{"margin-left":"4px"}},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),f(m(I),{class:"ion-align-items-center ion-justify-content-between"},{default:r((()=>[f(m(T),{size:"auto"},{default:r((()=>[k("",!0)])),_:1}),f(m(T),{size:"auto"},{default:r((()=>[f(m(U),{class:"btn-del",src:m(n)("/icon_userInfo/icon-delete.svg"),onClick:E((a=>$(e)),["stop"])},null,8,["src","onClick"])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)):k("",!0),"activities"==K.value?(u(!0),b(L,{key:1},_(m(l).announceList,(a=>(u(),d(m(z),{key:a.mainId,class:"mail-item",lines:"none"},{default:r((()=>[f(m(D),{class:"mail-content"},{default:r((()=>[M("div",H,S(a.startTime||""),1),M("h4",J,S(a.title||""),1),M("div",{class:j(["mail-detail",{"show-all":a.showDetail}])},S(a.content||""),3),f(m(I),{class:"ion-justify-content-end"},{default:r((()=>[f(m(T),{size:"auto"},{default:r((()=>[f(m(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:E((e=>Z(a)),["stop"])},{default:r((()=>[M("span",null,S(a.showDetail?"hide":"Show all"),1),f(m(U),{icon:e.mail.showDetail?m(P):m(V),style:{"margin-left":"4px"}},null,8,["icon"])])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024),f(m(I),{class:"ion-align-items-center ion-justify-content-between"},{default:r((()=>[f(m(T),{size:"auto"},{default:r((()=>[k("",!0)])),_:1}),f(m(T),{size:"auto"})])),_:1})])),_:2},1024)])),_:2},1024)))),128)):k("",!0)])),_:1}))])),_:1},512),[[h,!m(a).barLoading]])])),_:1}))}})}}}));
