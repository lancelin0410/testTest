import{r as b,c as $,I as w,J as s,G as e,K as m,b as j,L as H,D as o,R as S,S as T,U as z,F as D,Y as v,M as d,P as p,Z as B,Q as L}from"./@vue-3Wdfxk3_.js";import{o as G,w as F,x as V,y as R,v as q,p as J,z as x,r as U,h as y,i as h,l as A,k as I}from"./@ionic-ChxHNRcu.js";import{g as N,h as E}from"./ionicons-DCtDYcIg.js";import{d as _,u as K}from"./index-BtfuBToB.js";import{d as O}from"./pinia-i8UTD9O9.js";import{u as Q}from"./common-icPcROaw.js";import{_ as W}from"./NoData-DOLhCyWu.js";import"./@ionic_components_1-CAQXnsIn.js";import"./@stencil-C-gE1UvY.js";import"./@ionic_components_2-DUGZJZYA.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-CvOicv45.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./jsencrypt-Ve0Y4aUG.js";import"./vue-i18n-BmGSZPWT.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";function Y(i){return _({url:"/app/member/h5/siteMsg",method:"GET",params:i})}function Z(i){return _({url:"/app/member/h5/siteMsg/read",method:"PUT",data:i})}function X(i){return _({url:"/app/member/h5/siteMsg/del",method:"PUT",data:i})}function ee(i){return _({url:"/app/member/h5/announce",method:"GET",params:i})}function te(i){return _({url:"/app/member/h5/announce/read",method:"POST",data:i})}const ae=O("mail",()=>{const i=b([]),n=b([]),r=$(()=>i.value.some(c=>!c.readStatus));return{mailList:i,hasUnread:r,getMailList:async()=>{const c=await Y();c.code==="00000"&&(i.value=c.data.list||[],i.value.forEach(g=>g.showDetail=!1))},announceList:n,getAnnounceList:async()=>{const c=await ee();c.code==="00000"&&(n.value=c.data.list||[],n.value.forEach(g=>g.showDetail=!1))}}},{persistedState:{persist:!1}}),se={style:{"font-size":"0.8rem"}},oe={style:{"font-size":"1rem","font-weight":"800"}},ie=["innerHTML"],ne={style:{"font-size":"0.8rem"}},le={style:{"font-size":"1rem","font-weight":"800"}},re=["innerHTML"],De={__name:"Mail",setup(i){const n=K(),r=ae(),{getPublicUrl:M}=Q(),l=b("system"),c={system:"mailList",activities:"announceList"};G(async()=>{n.barLoading=!0,await r.getMailList(),n.barLoading=!1});const g=async()=>{l.value=="system"&&await r.getMailList(),l.value=="activities"&&await r.getAnnounceList()},k=async u=>{u.showDetail=!u.showDetail,u.readStatus||(l.value=="system"&&Z([{id:u.detailId}]),l.value=="activities"&&te([{id:u.mainId}]))},P=async u=>{n.barLoading=!0;const f=await X({mailId:u.detailId});f.code==="00000"?(await r.getMailList(),n.barLoading=!1,await(await toastController.create({message:t("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await toastController.create({message:f.msg||f.code,duration:1500,position:"top",color:"danger",translucent:!0})).present(),n.barLoading=!1)};return(u,f)=>(m(),w(e(J),{class:"mail"},{default:s(()=>[j(o(e(q),null,{default:s(()=>[o(e(F),{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=a=>l.value=a),mode:"ios",onIonChange:g},{default:s(()=>[o(e(V),{value:"system"},{default:s(()=>[S("System Notices")]),_:1}),o(e(V),{value:"activities"},{default:s(()=>[S("Activities")]),_:1})]),_:1},8,["modelValue"]),e(n).barLoading||e(r)[c[l.value]].length==0?(m(),w(W,{key:0,class:"no-data",desc:u.$t("mail.message.nodata")},null,8,["desc"])):(m(),w(e(R),{key:1,style:{"margin-top":"16px"}},{default:s(()=>[l.value=="system"?(m(!0),T(D,{key:0},z(e(r).mailList,a=>(m(),w(e(x),{key:a.detailId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(U),{class:"mail-content"},{default:s(()=>[d("div",se,p(a.gmtCreate||""),1),d("h4",oe,p(a.msgTitle||""),1),d("div",{class:B(["mail-detail",{"show-all":a.showDetail}]),innerHTML:a.msgContent},null,10,ie),o(e(y),{class:"ion-justify-content-end"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[o(e(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:L(C=>k(a),["stop"])},{default:s(()=>[d("span",null,p(a.showDetail?"hide":"Show all"),1),o(e(I),{icon:a.showDetail?e(N):e(E),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(y),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[v("",!0)]),_:1}),o(e(h),{size:"auto"},{default:s(()=>[o(e(I),{class:"btn-del",src:e(M)("/icon_userInfo/icon-delete.svg"),onClick:L(C=>P(a),["stop"])},null,8,["src","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):v("",!0),l.value=="activities"?(m(!0),T(D,{key:1},z(e(r).announceList,a=>(m(),w(e(x),{key:a.mainId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(U),{class:"mail-content"},{default:s(()=>[d("div",ne,p(a.startTime||""),1),d("h4",le,p(a.title||""),1),d("div",{class:B(["mail-detail",{"show-all":a.showDetail}]),innerHTML:a.content},null,10,re),o(e(y),{class:"ion-justify-content-end"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[o(e(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:L(C=>k(a),["stop"])},{default:s(()=>[d("span",null,p(a.showDetail?"hide":"Show all"),1),o(e(I),{icon:a.showDetail?e(N):e(E),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(y),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[v("",!0)]),_:1}),o(e(h),{size:"auto"})]),_:1})]),_:2},1024)]),_:2},1024))),128)):v("",!0)]),_:1}))]),_:1},512),[[H,!e(n).barLoading]])]),_:1}))}};export{De as default};
