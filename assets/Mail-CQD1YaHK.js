import{r as I,c as j,J as w,K as s,G as e,I as m,b as $,V as H,D as o,P as S,Q as T,R as D,F as z,U as v,M as d,N as p,Z as B,O as L}from"./@vue-DQPB5ixA.js";import{o as G,A as F,B as V,C as O,n as R,j as q,D as x,l as A,b as y,c as h,f as N,e as b}from"./@ionic-BzoWLFGj.js";import{g as U,h as E}from"./ionicons-DKP7Q_k0.js";import{r as _,u as J,b as K}from"./index-b0wqW7zq.js";import{d as Q}from"./pinia-CYwfShO_.js";import{_ as W}from"./NoData-7M6tt8IN.js";import"./@ionic_components_1-CAQXnsIn.js";import"./@stencil-C-gE1UvY.js";import"./@ionic_components_2-DUGZJZYA.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-CQQ818li.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./jsencrypt-Ve0Y4aUG.js";import"./vue-i18n-D3aLYNeJ.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";function Z(i){return _({url:"/app/member/h5/siteMsg",method:"GET",params:i})}function X(i){return _({url:"/app/member/h5/siteMsg/read",method:"PUT",data:i})}function Y(i){return _({url:"/app/member/h5/siteMsg/del",method:"PUT",data:i})}function ee(i){return _({url:"/app/member/h5/announce",method:"GET",params:i})}function te(i){return _({url:"/app/member/h5/announce/read",method:"POST",data:i})}const ae=Q("mail",()=>{const i=I([]),n=I([]),r=j(()=>i.value.some(c=>!c.readStatus));return{mailList:i,hasUnread:r,getMailList:async()=>{const c=await Z();c.code==="00000"&&(i.value=c.data.list||[],i.value.forEach(g=>g.showDetail=!1))},announceList:n,getAnnounceList:async()=>{const c=await ee();c.code==="00000"&&(n.value=c.data.list||[],n.value.forEach(g=>g.showDetail=!1))}}},{persistedState:{persist:!1}}),se={style:{"font-size":"0.8rem"}},oe={style:{"font-size":"1rem","font-weight":"800"}},ie=["innerHTML"],ne={style:{"font-size":"0.8rem"}},le={style:{"font-size":"1rem","font-weight":"800"}},re=["innerHTML"],De={__name:"Mail",setup(i){const n=J(),r=ae(),{getPublicUrl:M}=K(),l=I("system"),c={system:"mailList",activities:"announceList"};G(async()=>{n.barLoading=!0,await r.getMailList(),n.barLoading=!1});const g=async()=>{l.value=="system"&&await r.getMailList(),l.value=="activities"&&await r.getAnnounceList()},k=async u=>{u.showDetail=!u.showDetail,u.readStatus||(l.value=="system"&&X([{id:u.detailId}]),l.value=="activities"&&te([{id:u.mainId}]))},P=async u=>{n.barLoading=!0;const f=await Y({mailId:u.detailId});f.code==="00000"?(await r.getMailList(),n.barLoading=!1,await(await toastController.create({message:t("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await toastController.create({message:f.msg||f.code,duration:1500,position:"top",color:"danger",translucent:!0})).present(),n.barLoading=!1)};return(u,f)=>(m(),w(e(q),{class:"mail"},{default:s(()=>[$(o(e(R),null,{default:s(()=>[o(e(F),{modelValue:l.value,"onUpdate:modelValue":f[0]||(f[0]=a=>l.value=a),mode:"ios",onIonChange:g},{default:s(()=>[o(e(V),{value:"system"},{default:s(()=>[S("System Notices")]),_:1}),o(e(V),{value:"activities"},{default:s(()=>[S("Activities")]),_:1})]),_:1},8,["modelValue"]),e(n).barLoading||e(r)[c[l.value]].length==0?(m(),w(W,{key:0,class:"no-data",desc:u.$t("mail.message.nodata")},null,8,["desc"])):(m(),w(e(O),{key:1,style:{"margin-top":"16px"}},{default:s(()=>[l.value=="system"?(m(!0),T(z,{key:0},D(e(r).mailList,a=>(m(),w(e(x),{key:a.detailId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(A),{class:"mail-content"},{default:s(()=>[d("div",se,p(a.gmtCreate||""),1),d("h4",oe,p(a.msgTitle||""),1),d("div",{class:B(["mail-detail",{"show-all":a.showDetail}]),innerHTML:a.msgContent},null,10,ie),o(e(y),{class:"ion-justify-content-end"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[o(e(N),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:L(C=>k(a),["stop"])},{default:s(()=>[d("span",null,p(a.showDetail?"hide":"Show all"),1),o(e(b),{icon:a.showDetail?e(U):e(E),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(y),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[v("",!0)]),_:1}),o(e(h),{size:"auto"},{default:s(()=>[o(e(b),{class:"btn-del",src:e(M)("/icon_userInfo/icon-delete.svg"),onClick:L(C=>P(a),["stop"])},null,8,["src","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):v("",!0),l.value=="activities"?(m(!0),T(z,{key:1},D(e(r).announceList,a=>(m(),w(e(x),{key:a.mainId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(A),{class:"mail-content"},{default:s(()=>[d("div",ne,p(a.startTime||""),1),d("h4",le,p(a.title||""),1),d("div",{class:B(["mail-detail",{"show-all":a.showDetail}]),innerHTML:a.content},null,10,re),o(e(y),{class:"ion-justify-content-end"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[o(e(N),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:L(C=>k(a),["stop"])},{default:s(()=>[d("span",null,p(a.showDetail?"hide":"Show all"),1),o(e(b),{icon:a.showDetail?e(U):e(E),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(y),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(h),{size:"auto"},{default:s(()=>[v("",!0)]),_:1}),o(e(h),{size:"auto"})]),_:1})]),_:2},1024)]),_:2},1024))),128)):v("",!0)]),_:1}))]),_:1},512),[[H,!e(n).barLoading]])]),_:1}))}};export{De as default};
