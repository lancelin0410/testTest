import{r as _,H as P,I as S,J as l,L as o,M as a,C as e,E as t,N as f,O as v,j as E,a as R,U as T,P as U,Q as x,F as G,Y as X}from"./@vue-B0j_qcai.js";import{u as Z}from"./vue-router-BLYQmdkJ.js";import{u as tt}from"./vue-i18n-DzMZFiEd.js";import{u as W,g as k,M,K as at,t as b,e as ot,f as z,b as st,N as F,E as V,D as A,o as H,I as et,n as nt,r as it,p as lt,T as rt,k as dt,d as ct}from"./@ionic-18nICBu3.js";import{m as ut,c as wt,n as pt}from"./ionicons-CdrslGsx.js";import{c as j,u as ht,h as mt,m as ft,b as gt}from"./index-CBAZMc4h.js";import{g as _t,a as vt,c as bt}from"./withdraw-k7JEOECy.js";import"./@intlify-BAcCFw_v.js";import"./@stencil-DBaMOtEh.js";import"./@capacitor-CHoHO2YB.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-Ds326xZN.js";import"./jsencrypt-Ve0Y4aUG.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const At={class:"wrapper"},kt={class:"dialog-title"},$t={class:"dialog-content"},yt={class:"btn-group"},Pt={__name:"SetPasswordPopup",setup(O,{expose:C}){const $=W(),{popupEnter:I,popupLeave:r}=j(),u=_(!1),g=async()=>{u.value=!0},L=()=>{u.value=!1,$.push({name:"WithdrawPassword"})};return C({showDialog:g}),(c,d)=>(P(),S(t(M),{class:"setPassword-popup",isOpen:u.value,enterAnimation:t(I),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[o("div",At,[o("h3",kt,a(c.$t("withdraw.setPasswordPopup.title")),1),o("div",$t,a(c.$t("withdraw.setPasswordPopup.des")),1),o("div",yt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(L,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.goToSetPassword")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},Ct={class:"wrapper"},It={class:"dialog-title"},Lt={class:"dialog-content"},Dt={class:"btn-group"},Nt={__name:"BankCardPopup",setup(O,{expose:C}){const $=W(),{popupEnter:I,popupLeave:r}=j(),u=_(!1),g=async()=>{u.value=!0},L=()=>{u.value=!1,$.push({name:"BankCardList"})};return C({showDialog:g}),(c,d)=>(P(),S(t(M),{class:"bankCard-popup",isOpen:u.value,enterAnimation:t(I),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[o("div",Ct,[o("h3",It,a(c.$t("withdraw.bankCardPopup.title")),1),o("div",Lt,a(c.$t("withdraw.bankCardPopup.des")),1),o("div",Dt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(L,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.addNewAccount")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},St={class:"balance-card"},Bt={class:"balance-content"},zt={class:"balance-title"},Vt={class:"balance-amount"},Wt={style:{margin:"4px 0"}},Mt={class:"block-title ion-justify-content-between",style:{display:"flex"}},Ot={key:1,class:"bank-info"},Et={style:{margin:"4px 0"}},Rt={class:"block-title"},Tt=o("hr",null,null,-1),Ut={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Ft={slot:"end"},Ht={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},jt={slot:"end"},qt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Jt={slot:"end"},Kt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Qt={slot:"end"},Yt=o("hr",null,null,-1),xt={style:{margin:"4px 0"}},Gt={class:"block-title"},Xt={style:{"font-size":"0.8rem"}},Zt={style:{color:"#ffdf3f","margin-left":"4px"}},ta={style:{color:"#ffdf3f","margin-left":"4px"}},aa={class:"account-number"},oa={class:"account-text"},sa=o("br",null,null,-1),ea={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},na={slot:"end"},ia={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},la={slot:"end"},ra={style:{"font-size":"0.8rem",color:"#fa8484"}},da={style:{color:"#ffdf3f",margin:"0 4px"}},ca={style:{margin:"4px 0"}},ua={class:"block-title"},wa={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},pa={slot:"end"},ha={class:"block-title"},Va={__name:"Withdraw",setup(O){const C=Z(),{t:$}=tt(),I=W(),r=ht();mt();const{getPublicUrl:u}=gt(),g=_(null),L=_(null),c=_(!1),d=_(!1),D=_([]),m="â‚¹",y=_(0),N=_(0),i=E({withdrawAmount:0,remainingWithdrawLimit:"",remainingWithdrawCount:"",withdrawLimit:"",vipDailyLimit:"",balance:"",withdrawAccount:{},withdrawAccounts:[]}),w=E({withdrawAmount:0,withdrawFee:0,arrivalAmount:0,bankAccount:"",serviceCharge:0,withdrawPassword:""});at(async()=>{r.barLoading=!0;const s=await _t();if(s.code==="00000")if(i.withdrawAccounts=s.data,C.query.cardId){const n=i.withdrawAccounts.filter(B=>B.id==C.query.cardId);i.withdrawAccount=n.length>0?n[0]:i.withdrawAccounts[0]}else i.withdrawAccount=i.withdrawAccounts[0];else await(await b.create({message:bankData.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const p=await ft();p.code==="00000"?(d.value=!!p.data.withdrawPasswordValid,d.value||g.value.showDialog()):await(await b.create({message:p.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const h=await vt();h.code==="00000"?(N.value=r.appConfig.maxWithdrawAmount,y.value=r.appConfig.minWithdrawAmount,D.value=[y.value],i.withdrawLimit=h.data.withdrawLimit,i.balance=h.data.balance,i.withdrawAmount=y.value):await(await b.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.barLoading=!1});const q=s=>{i.withdrawAmount=Number(s)},J=()=>{d.value?I.push({name:"BankCardList"}):g.value.showDialog()},K=()=>{d.value?I.push({name:"BankCardList"}):g.value.showDialog()},Q=async()=>{if(!d.value){g.value.showDialog();return}if(i.withdrawAccounts.length==0){L.value.showDialog();return}if(Number(i.withdrawAmount)<=0){await(await b.create({message:$("withdraw.toast.text3"),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}if(Number(i.withdrawAmount)<y.value||Number(i.withdrawAmount)>N.value){await(await b.create({message:"Min: ".concat(y.value," Max: ").concat(N.value),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}r.fullLoading=!0,w.arrivalAmount=i.withdrawAmount,w.bankAccount=i.withdrawAccount.cardNo,w.withdrawAmount=i.withdrawAmount,w.withdrawPassword="",c.value=!0,r.fullLoading=!1},Y=async()=>{if(w.withdrawPassword.length==0){await(await b.create({message:$("withdraw.toast.text1"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}r.fullLoading=!0;const s=await bt({amount:Number(i.withdrawAmount),id:i.withdrawAccount.id,memberBankId:i.withdrawAccount.bankId,memberBankCardNo:r.encrypt.encrypt(i.withdrawAccount.cardNo),withdrawPassword:r.encrypt.encrypt(w.withdrawPassword)});s.code==="00000"?(await(await b.create({message:$("withdraw.toast.text2"),duration:1500,position:"top",color:"success",translucent:!0})).present(),c.value=!1):await(await b.create({message:s.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.fullLoading=!1};return(s,p)=>R((P(),S(t(dt),{class:"withdraw"},{default:l(()=>[e(t(H),null,{default:l(()=>{var h;return[o("div",St,[e(t(ot),{src:t(u)("/wallet/img-bg-balance.png")},null,8,["src"]),o("div",Bt,[o("div",zt,a(s.$t("withdraw.myBalance")),1),o("div",Vt,a(t(m))+" "+a((h=i.balance)==null?void 0:h.toLocaleString()),1)])]),o("div",Wt,[o("div",Mt,[o("span",null,a(s.$t("withdraw.bankAccount")),1),o("span",{class:"btn-change-account",onClick:f(K,["stop"])},a(s.$t("withdraw.changeBankAccount")),1)]),i.withdrawAccounts.length==0?(P(),S(t(k),{key:0,class:"btn-add-account",expand:"block",onClick:f(J,["stop"])},{default:l(()=>[e(t(z),{slot:"start",icon:t(ut)},null,8,["icon"]),o("span",null,a(s.$t("withdraw.addNewAccount")),1)]),_:1})):(P(),U("div",Ot,"Acc No: "+a(i.withdrawAccount.cardNo),1))]),o("div",Et,[o("div",Rt,[v(a(s.$t("withdraw.withdrawAmount"))+" ",1),o("span",null,"("+a(t(m))+" "+a(y.value)+" - "+a(N.value)+" )",1)]),e(t(st),{style:{margin:"8px 0"}},{default:l(()=>[(P(!0),U(G,null,x(D.value,(n,B)=>(P(),S(t(ct),{key:B,size:"3.8",class:X(["amount-item",{select:Number(n)==Number(i.withdrawAmount)}]),onClick:f(ma=>q(n),["stop"])},{default:l(()=>[o("div",null,a(t(m))+" "+a(n==null?void 0:n.toLocaleString()),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),e(t(F),{modelValue:i.withdrawAmount,"onUpdate:modelValue":p[0]||(p[0]=n=>i.withdrawAmount=n),label:t(m),type:"number",placeholder:s.$t("withdraw.withdrawAmount"),max:N.value,min:y.value,clearInput:!0},null,8,["modelValue","label","placeholder","max","min"])]),Tt,e(t(V),null,{default:l(()=>[e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[o("span",Ut,a(s.$t("withdraw.items1"))+":",1),o("span",Ft,a(t(m))+" "+a(((n=i.remainingWithdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[o("span",Ht,a(s.$t("withdraw.items2"))+":",1),o("span",jt,a(t(m))+" "+a(((n=i.vipDailyLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[o("span",qt,a(s.$t("withdraw.items3"))+":",1),o("span",Jt,a(t(m))+" "+a(((n=i.withdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[o("span",Kt,a(s.$t("withdraw.items4"))+":",1),o("span",Qt,a(((n=i.remainingWithdrawCount)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1})]),_:1}),Yt,o("div",xt,[o("div",Gt,a(s.$t("withdraw.tips.title"))+": ",1),o("span",Xt,[o("span",null,a(s.$t("withdraw.tips.tips1")),1),o("span",Zt,a(s.$t("withdraw.tips.tips2")),1),o("span",null,a(s.$t("withdraw.tips.tips3")),1),o("span",ta,a(s.$t("withdraw.tips.tips4")),1),v(". ")])]),R(e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(Q,["stop"])},{default:l(()=>[v(a(s.$t("withdraw.button.withdraw")),1)]),_:1},512),[[T,i.withdrawAmount]])]}),_:1}),e(Pt,{ref_key:"setPasswordPopup",ref:g},null,512),e(Nt,{ref_key:"bankCardPopup",ref:L},null,512),e(t(M),{class:"withdraw-info","is-open":c.value,"initial-breakpoint":1,breakpoints:[0,1]},{default:l(()=>[e(t(et),null,{default:l(()=>[e(t(nt),null,{default:l(()=>[e(t(it),null,{default:l(()=>[v(a(s.$t("withdraw.configPopup.title")),1)]),_:1}),e(t(lt),{style:{position:"absolute",top:"0",right:"16px"}},{default:l(()=>[e(t(k),{onClick:p[1]||(p[1]=f(h=>c.value=!1,["stop"]))},{default:l(()=>[e(t(z),{slot:"icon-only",icon:t(wt),color:"light"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(t(H),{class:"ion-padding"},{default:l(()=>{var h;return[o("div",aa,a(t(m))+" "+a((h=w.arrivalAmount)==null?void 0:h.toLocaleString()),1),o("div",oa,a(s.$t("withdraw.configPopup.arrivalAmount")),1),sa,e(t(V),null,{default:l(()=>[e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var n;return[o("span",ea,a(s.$t("withdraw.configPopup.title"))+":",1),o("span",na,a(t(m))+" "+a((n=w.withdrawAmount)==null?void 0:n.toLocaleString()),1)]}),_:1}),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var n;return[o("span",ia,a(s.$t("withdraw.configPopup.serviceCharge"))+":",1),o("span",la,a(t(m))+" "+a((n=w.serviceCharge)==null?void 0:n.toLocaleString()),1)]}),_:1}),o("div",ra,[o("span",null,a(s.$t("withdraw.configPopup.des1")),1),o("span",da,a(w.withdrawFee)+"%",1),o("span",null,a(s.$t("withdraw.configPopup.des2")),1)]),o("div",ca,[o("div",ua,a(s.$t("withdraw.configPopup.chooseBankAccount")),1),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>[o("span",wa,a(s.$t("withdraw.configPopup.yourBankAccount"))+":",1),o("span",pa,a(w.bankAccount),1)]),_:1})])]),_:1}),e(t(V),{class:"password-info",lines:"none",style:{margin:"4px 0"}},{default:l(()=>[o("div",ha,a(s.$t("withdraw.configPopup.withdrawPassword")),1),e(t(A),null,{default:l(()=>[e(t(F),{modelValue:w.withdrawPassword,"onUpdate:modelValue":p[2]||(p[2]=n=>w.withdrawPassword=n),type:"password",fill:"outline",placeholder:s.$t("withdraw.configPopup.placeHolder")},{default:l(()=>[e(t(z),{slot:"start",icon:t(pt)},null,8,["icon"]),e(t(rt),{slot:"end",color:"medium"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(Y,["stop"])},{default:l(()=>[v(a(s.$t("withdraw.button.withdraw")),1)]),_:1})]}),_:1})]),_:1},8,["is-open"])]),_:1},512)),[[T,!t(r).barLoading]])}};export{Va as default};
