import{r as v,H as C,I as S,J as i,L as o,M as t,C as e,E as a,N as f,O as b,j as O,a as Z,U as G,P as R,Q as X,F as Y,Z as tt}from"./@vue-FF6Ppp8k.js";import{u as at}from"./vue-router-BCw8xDr3.js";import{u as ot}from"./vue-i18n-Drh5Jv-N.js";import{u as z,g as k,Q as V,O as st,t as A,e as U,f as F,c as et,K as E,D as T,C as P,n as q,P as nt,a as it,m as lt,q as rt,o as dt,R as ct,l as ut,d as wt}from"./@ionic-LOXDGMDQ.js";import{m as pt,c as ht}from"./ionicons-BuhCiVJn.js";import{b as H,c as mt,u as ft,n as gt,a as _t,d as vt}from"./index-DXSjpOoF.js";import{g as bt,a as At,c as kt}from"./withdraw-C5Z78pxL.js";import"./@intlify-BAcCFw_v.js";import"./@ionic_components_1-CfuvXJ2N.js";import"./@stencil-pJInS8Bp.js";import"./@ionic_components_2-BmE8Yi_w.js";import"./@capacitor-CHoHO2YB.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-BYTB-Pq_.js";import"./jsencrypt-Ve0Y4aUG.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const $t={class:"wrapper"},yt={class:"dialog-title"},Pt={class:"dialog-content"},Ct={class:"btn-group"},It={__name:"SetPasswordPopup",setup(W,{expose:I}){const $=z(),{popupEnter:L,popupLeave:r}=H(),c=v(!1),D=async()=>{c.value=!0},g=()=>{c.value=!1,$.push({name:"WithdrawPassword"})};return I({showDialog:D}),(p,d)=>(C(),S(a(V),{class:"setPassword-popup",isOpen:c.value,enterAnimation:a(L),leaveAnimation:a(r),onDidDismiss:d[1]||(d[1]=_=>c.value=!1)},{default:i(()=>[o("div",$t,[o("h3",yt,t(p.$t("withdraw.setPasswordPopup.title")),1),o("div",Pt,t(p.$t("withdraw.setPasswordPopup.des")),1),o("div",Ct,[e(a(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(_=>c.value=!1,["stop"]))},{default:i(()=>[b(t(p.$t("withdraw.button.cancel")),1)]),_:1}),e(a(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(g,["stop"])},{default:i(()=>[b(t(p.$t("withdraw.button.goToSetPassword")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},Lt={class:"wrapper"},Dt={class:"dialog-title"},Nt={class:"dialog-content"},St={class:"btn-group"},Bt={__name:"BankCardPopup",setup(W,{expose:I}){const $=z(),{popupEnter:L,popupLeave:r}=H(),c=v(!1),D=async()=>{c.value=!0},g=()=>{c.value=!1,$.push({name:"BankCardList"})};return I({showDialog:D}),(p,d)=>(C(),S(a(V),{class:"bankCard-popup",isOpen:c.value,enterAnimation:a(L),leaveAnimation:a(r),onDidDismiss:d[1]||(d[1]=_=>c.value=!1)},{default:i(()=>[o("div",Lt,[o("h3",Dt,t(p.$t("withdraw.bankCardPopup.title")),1),o("div",Nt,t(p.$t("withdraw.bankCardPopup.des")),1),o("div",St,[e(a(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(_=>c.value=!1,["stop"]))},{default:i(()=>[b(t(p.$t("withdraw.button.cancel")),1)]),_:1}),e(a(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(g,["stop"])},{default:i(()=>[b(t(p.$t("withdraw.button.addNewAccount")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},zt={class:"balance-card"},Vt={class:"balance-content"},Wt={class:"balance-title"},Mt={class:"balance-amount"},Ot={style:{margin:"4px 0"}},Rt={class:"block-title ion-justify-content-between",style:{display:"flex"}},Ut={key:1,class:"bank-info"},Ft={style:{margin:"4px 0"}},Et={class:"block-title"},Tt=o("hr",null,null,-1),qt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Ht={slot:"end"},jt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Qt={slot:"end"},xt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Jt={slot:"end"},Kt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Zt={slot:"end"},Gt=o("hr",null,null,-1),Xt={style:{margin:"4px 0"}},Yt={class:"block-title"},ta={style:{"font-size":"0.8rem"}},aa={style:{color:"#ffdf3f","margin-left":"4px"}},oa={style:{color:"#ffdf3f","margin-left":"4px"}},sa={class:"account-number"},ea={class:"account-text"},na=o("br",null,null,-1),ia={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},la={slot:"end"},ra={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},da={slot:"end"},ca={style:{"font-size":"0.8rem",color:"#fa8484"}},ua={style:{color:"#ffdf3f",margin:"0 4px"}},wa={style:{margin:"4px 0"}},pa={class:"block-title"},ha={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},ma={slot:"end"},fa={style:{margin:"4px 0"}},ga={class:"block-title"},Ua={__name:"Withdraw",setup(W){const I=at(),{t:$}=ot(),L=z(),r=mt();ft();const{getPublicUrl:c}=_t(),{getImgUrl:D}=vt(),g=v(null),p=v(null),d=v(!1),_=v(!1),M=v([]),h="â‚¹",y=v(0),N=v(0),l=O({withdrawAmount:0,remainingWithdrawLimit:"",remainingWithdrawCount:"",withdrawLimit:"",vipDailyLimit:"",balance:"",withdrawAccount:{},withdrawAccounts:[]}),u=O({withdrawAmount:0,withdrawFee:0,arrivalAmount:0,bankAccount:"",serviceCharge:0,withdrawPassword:""});st(async()=>{r.barLoading=!0;const s=await bt();if(s.code==="00000")if(l.withdrawAccounts=s.data,I.query.cardId){const n=l.withdrawAccounts.filter(B=>B.id==I.query.cardId);l.withdrawAccount=n.length>0?n[0]:l.withdrawAccounts[0]}else l.withdrawAccount=l.withdrawAccounts[0];else await(await A.create({message:bankData.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const w=await gt();w.code==="00000"?(_.value=!!w.data.withdrawPasswordValid,_.value||g.value.showDialog()):await(await A.create({message:w.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const m=await At();m.code==="00000"?(N.value=r.appConfig.maxWithdrawAmount,y.value=r.appConfig.minWithdrawAmount,M.value=[y.value],l.balance=m.data.balance,l.withdrawAmount=y.value):await(await A.create({message:m.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.barLoading=!1});const j=s=>{l.withdrawAmount=Number(s)},Q=()=>{_.value?L.push({name:"BankCardList"}):g.value.showDialog()},x=()=>{_.value?L.push({name:"BankCardList"}):g.value.showDialog()},J=async()=>{if(!_.value){g.value.showDialog();return}if(l.withdrawAccounts.length==0){p.value.showDialog();return}if(Number(l.withdrawAmount)<=0){await(await A.create({message:$("withdraw.toast.text3"),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}if(Number(l.withdrawAmount)<y.value||Number(l.withdrawAmount)>N.value){await(await A.create({message:"Min: ".concat(y.value," Max: ").concat(N.value),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}r.fullLoading=!0,u.arrivalAmount=l.withdrawAmount,u.bankAccount=l.withdrawAccount.cardNo,u.withdrawAmount=l.withdrawAmount,u.withdrawPassword="",d.value=!0,r.fullLoading=!1},K=async()=>{if(u.withdrawPassword.length==0){await(await A.create({message:$("withdraw.toast.text1"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}r.fullLoading=!0;const s=await kt({amount:Number(l.withdrawAmount),id:l.withdrawAccount.id,memberBankId:l.withdrawAccount.bankId,memberBankCardNo:r.encrypt.encrypt(l.withdrawAccount.cardNo),withdrawPassword:r.encrypt.encrypt(u.withdrawPassword)});s.code==="00000"?(await(await A.create({message:$("withdraw.toast.text2"),duration:1500,position:"top",color:"success",translucent:!0})).present(),d.value=!1):await(await A.create({message:s.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.fullLoading=!1};return(s,w)=>Z((C(),S(a(ut),{class:"withdraw"},{default:i(()=>[e(a(q),null,{default:i(()=>{var m;return[o("div",zt,[e(a(U),{src:a(c)("/wallet/img-bg-balance.png")},null,8,["src"]),o("div",Vt,[o("div",Wt,t(s.$t("withdraw.myBalance")),1),o("div",Mt,t(a(h))+" "+t((m=l.balance)==null?void 0:m.toLocaleString()),1)])]),o("div",Ot,[o("div",Rt,[o("span",null,t(s.$t("withdraw.bankAccount")),1),o("span",{class:"btn-change-account",onClick:f(x,["stop"])},t(s.$t("withdraw.changeBankAccount")),1)]),l.withdrawAccounts.length==0?(C(),S(a(k),{key:0,class:"btn-add-account",expand:"block",onClick:f(Q,["stop"])},{default:i(()=>[e(a(F),{slot:"start",icon:a(pt)},null,8,["icon"]),o("span",null,t(s.$t("withdraw.addNewAccount")),1)]),_:1})):(C(),R("div",Ut,"Acc No: "+t(l.withdrawAccount.cardNo),1))]),o("div",Ft,[o("div",Et,[b(t(s.$t("withdraw.withdrawAmount"))+" ",1),o("span",null,"("+t(a(h))+" "+t(y.value)+" - "+t(N.value)+" )",1)]),e(a(et),{style:{margin:"8px 0"}},{default:i(()=>[(C(!0),R(Y,null,X(M.value,(n,B)=>(C(),S(a(wt),{key:B,size:"3.8",class:tt(["amount-item",{select:Number(n)==Number(l.withdrawAmount)}]),onClick:f(_a=>j(n),["stop"])},{default:i(()=>[o("div",null,t(a(h))+" "+t(n==null?void 0:n.toLocaleString()),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),e(a(E),{modelValue:l.withdrawAmount,"onUpdate:modelValue":w[0]||(w[0]=n=>l.withdrawAmount=n),label:a(h),type:"number",placeholder:s.$t("withdraw.withdrawAmount"),max:N.value,min:y.value,clearInput:!0},null,8,["modelValue","label","placeholder","max","min"])]),Tt,e(a(T),null,{default:i(()=>[e(a(P),{class:"limit-item",lines:"none"},{default:i(()=>{var n;return[o("span",qt,t(s.$t("withdraw.items1"))+":",1),o("span",Ht,t(a(h))+" "+t(((n=l.remainingWithdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(a(P),{class:"limit-item",lines:"none"},{default:i(()=>{var n;return[o("span",jt,t(s.$t("withdraw.items2"))+":",1),o("span",Qt,t(a(h))+" "+t(((n=l.vipDailyLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(a(P),{class:"limit-item",lines:"none"},{default:i(()=>{var n;return[o("span",xt,t(s.$t("withdraw.items3"))+":",1),o("span",Jt,t(a(h))+" "+t(((n=l.withdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(a(P),{class:"limit-item",lines:"none"},{default:i(()=>{var n;return[o("span",Kt,t(s.$t("withdraw.items4"))+":",1),o("span",Zt,t(((n=l.remainingWithdrawCount)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1})]),_:1}),Gt,o("div",Xt,[o("div",Yt,t(s.$t("withdraw.tips.title"))+": ",1),o("span",ta,[o("span",null,t(s.$t("withdraw.tips.tips1")),1),o("span",aa,t(s.$t("withdraw.tips.tips2")),1),o("span",null,t(s.$t("withdraw.tips.tips3")),1),o("span",oa,t(s.$t("withdraw.tips.tips4")),1),b(". ")])])]}),_:1}),e(a(nt),null,{default:i(()=>[e(a(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(J,["stop"])},{default:i(()=>[b(t(s.$t("withdraw.button.withdraw")),1)]),_:1})]),_:1}),e(It,{ref_key:"setPasswordPopup",ref:g},null,512),e(Bt,{ref_key:"bankCardPopup",ref:p},null,512),e(a(V),{class:"withdraw-info","is-open":d.value,"initial-breakpoint":1,breakpoints:[0,1]},{default:i(()=>[e(a(it),null,{default:i(()=>[e(a(lt),null,{default:i(()=>[e(a(rt),null,{default:i(()=>[b(t(s.$t("withdraw.configPopup.title")),1)]),_:1}),e(a(dt),{style:{position:"absolute",top:"0",right:"16px"}},{default:i(()=>[e(a(k),{onClick:w[1]||(w[1]=f(m=>d.value=!1,["stop"]))},{default:i(()=>[e(a(F),{slot:"icon-only",icon:a(ht),color:"light"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(a(q),{class:"ion-padding"},{default:i(()=>{var m;return[o("div",sa,t(a(h))+" "+t((m=u.arrivalAmount)==null?void 0:m.toLocaleString()),1),o("div",ea,t(s.$t("withdraw.configPopup.arrivalAmount")),1),na,e(a(T),null,{default:i(()=>[e(a(P),{class:"detail-item",lines:"none"},{default:i(()=>{var n;return[o("span",ia,t(s.$t("withdraw.configPopup.title"))+":",1),o("span",la,t(a(h))+" "+t((n=u.withdrawAmount)==null?void 0:n.toLocaleString()),1)]}),_:1}),e(a(P),{class:"detail-item",lines:"none"},{default:i(()=>{var n;return[o("span",ra,t(s.$t("withdraw.configPopup.serviceCharge"))+":",1),o("span",da,t(a(h))+" "+t((n=u.serviceCharge)==null?void 0:n.toLocaleString()),1)]}),_:1}),o("div",ca,[o("span",null,t(s.$t("withdraw.configPopup.des1")),1),o("span",ua,t(u.withdrawFee)+"%",1),o("span",null,t(s.$t("withdraw.configPopup.des2")),1)]),o("div",wa,[o("div",pa,t(s.$t("withdraw.configPopup.chooseBankAccount")),1),e(a(P),{class:"detail-item",lines:"none"},{default:i(()=>[o("span",ha,t(s.$t("withdraw.configPopup.yourBankAccount"))+":",1),o("span",ma,t(u.bankAccount),1)]),_:1})])]),_:1}),o("div",fa,[o("div",ga,t(s.$t("withdraw.configPopup.withdrawPassword")),1),e(a(E),{modelValue:u.withdrawPassword,"onUpdate:modelValue":w[2]||(w[2]=n=>u.withdrawPassword=n),type:"password",placeholder:s.$t("withdraw.configPopup.placeHolder")},{default:i(()=>[e(a(U),{class:"input-prefix",slot:"start",src:a(D)("/account/w-password.png")},null,8,["src"]),e(a(ct),{slot:"end",color:"medium"})]),_:1},8,["modelValue","placeholder"])]),e(a(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(K,["stop"])},{default:i(()=>[b(t(s.$t("withdraw.button.withdraw")),1)]),_:1})]}),_:1})]),_:1},8,["is-open"])]),_:1},512)),[[G,!a(r).barLoading]])}};export{Ua as default};
