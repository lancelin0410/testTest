import{r as g,k as J,I,J as o,G as a,K as i,b as P,L as Q,D as n,S as B,U as L,F as A,Q as u,M as w,P as d,Y as H,R as v,Z as T}from"./@vue-3Wdfxk3_.js";import{u as K}from"./vue-i18n-BmGSZPWT.js";import{o as Y,t as C,u as Z,y as x,l as h,k as r,M as j,f as X,s as aa,G as ea,J as ta,v as S,z as k,N as na,E as _,D as oa,p as la,Q as sa,R as ca,T as ra,O as ia}from"./@ionic-ChxHNRcu.js";import{m as ua,b as da,g as pa,h as ma,o as fa,q as ka,u as ba,v as ga,w as Ia,x as $}from"./ionicons-DCtDYcIg.js";import{u as va,b as Ca}from"./index-BtfuBToB.js";import{b as Na,g as ya,d as wa,s as ha,e as _a}from"./withdraw-DCpFKFrH.js";import"./@intlify-BAcCFw_v.js";import"./@ionic_components_1-CAQXnsIn.js";import"./@stencil-C-gE1UvY.js";import"./@ionic_components_2-DUGZJZYA.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-CvOicv45.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-i8UTD9O9.js";import"./jsencrypt-Ve0Y4aUG.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const Va={slot:"end"},Ba={style:{color:"#fdea5a"}},Ka={__name:"BankCardList",setup(La){const{t:D}=K(),M=Z(),c=va(),{headerAnimation:O,leftAnimation:U,leftAnimationLeave:F}=Ca(),p=g([]),b=g({}),m=g(!1),f=g([]),e=J({id:0,bank:null,accountName:null,accountNumber:null,CNIC:null,accountIfsc:null});Y(async()=>{c.barLoading=!0,await N(),c.barLoading=!1});const N=async()=>{const t=await Na();t.code==="00000"&&(f.value=t.data);const l=await ya();l.code==="00000"?(p.value=l.data,b.value=p.value.length>0?p.value[0]:{}):await(await C.create({message:t.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()},R=()=>{e.id=0,e.bank=f.value[0],e.accountName=null,e.accountNumber=null,e.CNIC=null,e.accountIfsc=e.bank.code,m.value=!0},W=t=>{e.id=t.id;const l=f.value.filter(s=>s.id==t.bankId);e.bank=l.length>0?l[0]:{},e.accountName=t.realName,e.accountNumber=t.cardNo,e.accountIfsc=t.ifsc,m.value=!0},z=async t=>{c.fullLoading=!0,console.log(t),(await wa(t)).code==="00000"&&(await(await C.create({message:"Success",duration:1500,position:"top",translucent:!0,icon:$,color:"success"})).present(),await N(),c.fullLoading=!1),c.fullLoading=!1},E=async()=>{if(!e.bank||!e.accountName||!e.accountNumber||!e.accountIfsc)return;if(e.accountIfsc.split("")[4]!="0"){await(await C.create({message:D("account.bankCard.tips.ifscTips"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}c.fullLoading=!0;let t;e.id==0?t=await ha({bankId:e.bank.id,bankType:e.bank.bankType,realName:c.encrypt.encrypt(e.accountName),cardNo:c.encrypt.encrypt(e.accountNumber),ifsc:e.accountIfsc}):t=await _a({id:e.id,bankId:e.bank.id,bankType:e.bank.bankType,realName:c.encrypt.encrypt(e.accountName),cardNo:c.encrypt.encrypt(e.accountNumber),ifsc:e.accountIfsc}),t.code==="00000"&&(await(await C.create({message:"Success",duration:1500,position:"top",translucent:!0,icon:$,color:"success"})).present(),await N(),m.value=!1),c.fullLoading=!1},q=(t,l)=>t&&l?t.id===l.id:t===l,G=t=>{b.value=t,M.navigate({name:"Withdraw",query:{cardId:b.value.id}},"back","replace",O)};return(t,l)=>(i(),I(a(la),{class:"bank-card-list"},{default:o(()=>[P(n(a(S),null,{default:o(()=>[n(a(x),null,{default:o(()=>[(i(!0),B(A,null,L(p.value,(s,y)=>(i(),I(a(sa),{key:y},{default:o(()=>[n(a(k),{lines:"none",class:T(["account-item",{select:b.value.id==s.id}]),onClick:u(V=>G(s),["stop"])},{default:o(()=>[w("span",null,d(t.$t("account.bankCard.text.accNo"))+" "+d(s.cardNo),1),w("span",Va,[n(a(r),{icon:a(ga),color:"warning",size:"large",onClick:u(V=>W(s),["stop"])},null,8,["icon","onClick"])])]),_:2},1032,["class","onClick"]),n(a(ca),{slot:"end"},{default:o(()=>[n(a(ra),{color:"danger"},{default:o(()=>[n(a(r),{slot:"icon-only",icon:a(Ia),onClick:u(V=>z(s.id),["stop"])},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),p.value.length<a(c).appConfig.bankCardLimit?(i(),I(a(h),{key:0,fill:"clear",expand:"block",onClick:u(R,["stop"])},{default:o(()=>[n(a(r),{slot:"start",icon:a(ua),style:{color:"#fdea5a"}},null,8,["icon"]),w("span",Ba,d(t.$t("account.bankCard.text.addBankCardText")),1)]),_:1})):H("",!0),n(a(j),{class:"account-info","is-open":m.value,enterAnimation:a(U),leaveAnimation:a(F)},{default:o(()=>[n(a(X),null,{default:o(()=>[n(a(aa),null,{default:o(()=>[n(a(ea),{slot:"start"},{default:o(()=>[n(a(h),{onClick:l[0]||(l[0]=u(s=>m.value=!1,["stop"]))},{default:o(()=>[n(a(r),{slot:"icon-only",icon:a(da),color:"light"},null,8,["icon"])]),_:1})]),_:1}),n(a(ta),null,{default:o(()=>[v(d(t.$t("account.header.withdrawalBankTitle")),1)]),_:1})]),_:1})]),_:1}),n(a(S),{class:"ion-padding"},{default:o(()=>[n(a(x),{lines:"none"},{default:o(()=>[n(a(k),{style:{margin:"4px 0"}},{default:o(()=>[n(a(na),{modelValue:e.bank,"onUpdate:modelValue":l[1]||(l[1]=s=>e.bank=s),class:T(["account-type-select",{hide:f.value.length<2}]),mode:"md",interface:"action-sheet",fill:"outline",color:"danger","toggle-icon":a(pa),"expanded-icon":a(ma),compareWith:q,onIonChange:l[2]||(l[2]=()=>e.accountIfsc=e.bank.code)},{default:o(()=>[n(a(r),{slot:"start",icon:a(fa)},null,8,["icon"]),(i(!0),B(A,null,L(f.value,(s,y)=>(i(),I(a(ia),{key:y,value:s},{default:o(()=>[v(d(s.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class","toggle-icon","expanded-icon"])]),_:1}),n(a(k),{style:{margin:"4px 0"}},{default:o(()=>[n(a(_),{modelValue:e.accountName,"onUpdate:modelValue":l[3]||(l[3]=s=>e.accountName=s),placeholder:t.$t("account.bankCard.labels.accountName")},{default:o(()=>[n(a(r),{slot:"start",icon:a(ka)},null,8,["icon"])]),_:1},8,["modelValue","placeholder"])]),_:1}),n(a(k),{style:{margin:"4px 0"}},{default:o(()=>[n(a(_),{modelValue:e.accountNumber,"onUpdate:modelValue":l[4]||(l[4]=s=>e.accountNumber=s),placeholder:t.$t("account.bankCard.labels.accountNumber")},{default:o(()=>[n(a(r),{slot:"start",icon:a(ba)},null,8,["icon"])]),_:1},8,["modelValue","placeholder"])]),_:1}),n(a(k),{style:{margin:"4px 0"}},{default:o(()=>[n(a(_),{modelValue:e.accountIfsc,"onUpdate:modelValue":l[5]||(l[5]=s=>e.accountIfsc=s),placeholder:t.$t("account.bankCard.labels.accountIfsc")},{default:o(()=>[n(a(oa),{slot:"start"},{default:o(()=>[v("ISFC")]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),n(a(h),{class:"btn-confirm",expand:"block",shape:"round",style:{margin:"16px 0"},onClick:u(E,["stop"])},{default:o(()=>[v(d(t.$t("account.button.confirmCapital")),1)]),_:1})]),_:1})]),_:1},8,["is-open","enterAnimation","leaveAnimation"])]),_:1},512),[[Q,!a(c).barLoading]])]),_:1}))}};export{Ka as default};
