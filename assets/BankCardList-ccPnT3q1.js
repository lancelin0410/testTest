import{r as b,j as z,H as m,I as h,J as s,a as H,U as P,E as t,C as o,P as $,Q as L,F as T,N as u,L as r,M as i,O as y,Z as S}from"./@vue-FF6Ppp8k.js";import{u as Q}from"./vue-i18n-Drh5Jv-N.js";import{O as R,t as g,D as j,g as w,f as I,Q as J,a as K,m as Z,o as G,q as X,n as x,E as Y,K as _,e as V,l as aa,u as ta,T as ea,C as na,U as oa,V as la,F as sa}from"./@ionic-LOXDGMDQ.js";import{m as ca,e as ra,g as ia,h as ua,n as da,o as pa,p as O}from"./ionicons-BuhCiVJn.js";import{c as ma,d as fa}from"./index-DXSjpOoF.js";import{b as ka,g as ba,d as ga,s as Ia,e as va}from"./withdraw-C5Z78pxL.js";import"./@intlify-BAcCFw_v.js";import"./@ionic_components_1-CfuvXJ2N.js";import"./@stencil-pJInS8Bp.js";import"./@ionic_components_2-BmE8Yi_w.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-BCw8xDr3.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./pinia-BYTB-Pq_.js";import"./jsencrypt-Ve0Y4aUG.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";const Ca={slot:"end"},Na={style:{color:"#fdea5a"}},ha={style:{margin:"4px 0"}},ya={class:"block-title"},wa={style:{margin:"4px 0"}},_a={class:"block-title"},Va={style:{margin:"4px 0"}},Ba={class:"block-title"},$a={style:{margin:"4px 0"}},La={class:"block-title"},Ga={__name:"BankCardList",setup(Ta){const{t:U}=Q(),D=ta(),c=ma(),{getImgUrl:v}=fa(),f=b([]),k=b({}),d=b(!1),p=b([]),a=z({id:0,bank:null,accountName:null,accountNumber:null,CNIC:null,accountIfsc:null});R(async()=>{c.barLoading=!0,await C(),c.barLoading=!1});const C=async()=>{const e=await ka();e.code==="00000"&&(p.value=e.data);const n=await ba();n.code==="00000"?(f.value=n.data,k.value=f.value.length>0?f.value[0]:{}):await(await g.create({message:e.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present()},M=()=>{a.id=0,a.bank=p.value[0],a.accountName=null,a.accountNumber=null,a.CNIC=null,a.accountIfsc=a.bank.code,d.value=!0},F=e=>{a.id=e.id;const n=p.value.filter(l=>l.id==e.bankId);a.bank=n.length>0?n[0]:{},a.accountName=e.realName,a.accountNumber=e.cardNo,a.accountIfsc=e.ifsc,d.value=!0},A=async e=>{c.fullLoading=!0,console.log(e),(await ga(e)).code==="00000"&&(await(await g.create({message:"Success",duration:1500,position:"top",translucent:!0,icon:O,color:"success"})).present(),await C(),c.fullLoading=!1),c.fullLoading=!1},E=async()=>{if(!a.bank||!a.accountName||!a.accountNumber||!a.accountIfsc)return;if(a.accountIfsc.split("")[4]!="0"){await(await g.create({message:U("account.bankCard.tips.ifscTips"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}c.fullLoading=!0;let e;a.id==0?e=await Ia({bankId:a.bank.id,bankType:a.bank.bankType,realName:c.encrypt.encrypt(a.accountName),cardNo:c.encrypt.encrypt(a.accountNumber),ifsc:a.accountIfsc}):e=await va({id:a.id,bankId:a.bank.id,bankType:a.bank.bankType,realName:c.encrypt.encrypt(a.accountName),cardNo:c.encrypt.encrypt(a.accountNumber),ifsc:a.accountIfsc}),e.code==="00000"&&(await(await g.create({message:"Success",duration:1500,position:"top",translucent:!0,icon:O,color:"success"})).present(),await C(),d.value=!1),c.fullLoading=!1},W=(e,n)=>e&&n?e.id===n.id:e===n,q=e=>{k.value=e,D.replace({name:"Withdraw",query:{cardId:k.value.id}})};return(e,n)=>(m(),h(t(aa),{class:"bank-card-list"},{default:s(()=>[H(o(t(x),null,{default:s(()=>[o(t(j),null,{default:s(()=>[(m(!0),$(T,null,L(f.value,(l,N)=>(m(),h(t(ea),{key:N},{default:s(()=>[o(t(na),{lines:"none",class:S(["account-item",{select:k.value.id==l.id}]),onClick:u(B=>q(l),["stop"])},{default:s(()=>[r("span",null,i(e.$t("account.bankCard.text.accNo"))+" "+i(l.cardNo),1),r("span",Ca,[o(t(I),{icon:t(da),color:"warning",size:"large",onClick:u(B=>F(l),["stop"])},null,8,["icon","onClick"])])]),_:2},1032,["class","onClick"]),o(t(oa),{slot:"end"},{default:s(()=>[o(t(la),{color:"danger"},{default:s(()=>[o(t(I),{slot:"icon-only",icon:t(pa),onClick:u(B=>A(l.id),["stop"])},null,8,["icon","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1}),o(t(w),{fill:"clear",expand:"block",onClick:u(M,["stop"])},{default:s(()=>[o(t(I),{slot:"start",icon:t(ca),style:{color:"#fdea5a"}},null,8,["icon"]),r("span",Na,i(e.$t("account.bankCard.text.addBankCardText")),1)]),_:1}),o(t(J),{class:"account-info","is-open":d.value},{default:s(()=>[o(t(K),null,{default:s(()=>[o(t(Z),null,{default:s(()=>[o(t(G),{slot:"start"},{default:s(()=>[o(t(w),{onClick:n[0]||(n[0]=u(l=>d.value=!1,["stop"]))},{default:s(()=>[o(t(I),{slot:"icon-only",icon:t(ra),color:"light"},null,8,["icon"])]),_:1})]),_:1}),o(t(X),null,{default:s(()=>[y(i(e.$t("account.header.withdrawalBankTitle")),1)]),_:1})]),_:1})]),_:1}),o(t(x),{class:"ion-padding"},{default:s(()=>[r("div",ha,[r("div",ya,i(e.$t("account.bankCard.labels.bank")),1),o(t(Y),{modelValue:a.bank,"onUpdate:modelValue":n[1]||(n[1]=l=>a.bank=l),class:S(["account-type-select",{hide:p.value.length<2}]),mode:"md",interface:"popover",fill:"outline",color:"danger","toggle-icon":t(ia),"expanded-icon":t(ua),compareWith:W,onIonChange:n[2]||(n[2]=()=>a.accountIfsc=a.bank.code)},{default:s(()=>[(m(!0),$(T,null,L(p.value,(l,N)=>(m(),h(t(sa),{key:N,value:l},{default:s(()=>[y(i(l.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","class","toggle-icon","expanded-icon"])]),r("div",wa,[r("div",_a,i(e.$t("account.bankCard.labels.accountName")),1),o(t(_),{modelValue:a.accountName,"onUpdate:modelValue":n[3]||(n[3]=l=>a.accountName=l),placeholder:e.$t("account.bankCard.placeholder.accountName")},{default:s(()=>[o(t(V),{class:"input-prefix",slot:"start",src:t(v)("/account/icon/user.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])]),r("div",Va,[r("div",Ba,i(e.$t("account.bankCard.labels.accountNumber")),1),o(t(_),{modelValue:a.accountNumber,"onUpdate:modelValue":n[4]||(n[4]=l=>a.accountNumber=l),placeholder:e.$t("account.bankCard.placeholder.accountNumber")},{default:s(()=>[o(t(V),{class:"input-prefix",slot:"start",src:t(v)("/account/icon/password.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])]),r("div",$a,[r("div",La,i(e.$t("account.bankCard.labels.accountIfsc")),1),o(t(_),{modelValue:a.accountIfsc,"onUpdate:modelValue":n[5]||(n[5]=l=>a.accountIfsc=l),placeholder:e.$t("account.bankCard.placeholder.accountIfsc")},{default:s(()=>[o(t(V),{class:"input-prefix",slot:"start",src:t(v)("/account/icon/IFSC.png")},null,8,["src"])]),_:1},8,["modelValue","placeholder"])]),o(t(w),{class:"btn-confirm",expand:"block",shape:"round",style:{margin:"16px 0"},onClick:u(E,["stop"])},{default:s(()=>[y(i(e.$t("account.button.confirmCapital")),1)]),_:1})]),_:1})]),_:1},8,["is-open"])]),_:1},512),[[P,!t(c).barLoading]])]),_:1}))}};export{Ga as default};
