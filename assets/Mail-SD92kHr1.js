import{r as k,c as $,H as f,I as w,J as s,a as j,U as O,E as e,C as o,O as S,P as D,Q as z,F as B,S as _,L as d,M as m,Z as V,N as I}from"./@vue-FF6Ppp8k.js";import{O as F,H as G,J as T,D as H,n as J,l as q,C as x,k as N,c as v,d as p,g as A,f as L}from"./@ionic-LOXDGMDQ.js";import{g as E,h as U}from"./ionicons-BuhCiVJn.js";import{r as y,c as Q,a as R}from"./index-DXSjpOoF.js";import{d as W}from"./pinia-BYTB-Pq_.js";import{_ as Z}from"./NoData-BttprgHy.js";import"./@ionic_components_1-CfuvXJ2N.js";import"./@stencil-pJInS8Bp.js";import"./@ionic_components_2-BmE8Yi_w.js";import"./@capacitor-CHoHO2YB.js";import"./vue-router-BCw8xDr3.js";import"./localforage-qzmIiYbH.js";import"./@adjustcom-Dev-Q0DI.js";import"./jsencrypt-Ve0Y4aUG.js";import"./vue-i18n-Drh5Jv-N.js";import"./@intlify-BAcCFw_v.js";import"./pinia-plugin-persistedstate-2-DcGv4gw_.js";import"./@awesome-cordova-plugins-CT7d7gQP.js";import"./rxjs-C3tg6S9t.js";import"./tslib-BHBn2Msb.js";function K(i){return y({url:"/app/member/h5/siteMsg",method:"GET",params:i})}function X(i){return y({url:"/app/member/h5/siteMsg/read",method:"POST",data:i})}function Y(i){return y({url:"/app/member/h5/siteMsg/del",method:"PUT",data:i})}function ee(i){return y({url:"/app/member/h5/announce",method:"GET",params:i})}const te=W("mail",()=>{const i=k([]),l=k([]),r=$(()=>i.value.some(c=>!c.readStatus));return{mailList:i,hasUnread:r,getMailList:async()=>{const c=await K();c.code==="00000"&&(i.value=c.data.list||[],i.value.forEach(g=>g.showDetail=!1))},announceList:l,getAnnounceList:async()=>{const c=await ee();c.code==="00000"&&(l.value=c.data.list||[],l.value.forEach(g=>g.showDetail=!1))}}},{persistedState:{persist:!1}}),ae={style:{"font-size":"0.8rem"}},se={style:{"font-size":"1rem","font-weight":"800"}},oe={style:{"font-size":"0.8rem"}},ie={style:{"font-size":"1rem","font-weight":"800"}},Me={__name:"Mail",setup(i){const l=Q(),r=te(),{getPublicUrl:b}=R(),n=k("system"),c={system:"mailList",activities:"announceList"};F(async()=>{l.barLoading=!0,await r.getMailList(),l.barLoading=!1});const g=async()=>{n.value=="system"&&await r.getMailList(),n.value=="activities"&&await r.getAnnounceList()},C=async u=>{u.showDetail=!u.showDetail,mail.readStatus||(n.value=="system"&&X({id:u.detailId}),n.value=="activities"&&readAnnounce({id:u.mainId}))},P=async u=>{l.barLoading=!0;const h=await Y({mailId:u.detailId});h.code==="00000"?(await r.getMailList(),l.barLoading=!1,await(await toastController.create({message:t("mail.message.deleteSuccess"),duration:1500,position:"top",color:"success",translucent:!0})).present()):(await(await toastController.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),l.barLoading=!1)};return(u,h)=>(f(),w(e(q),{class:"mail"},{default:s(()=>[j(o(e(J),null,{default:s(()=>[o(e(G),{modelValue:n.value,"onUpdate:modelValue":h[0]||(h[0]=a=>n.value=a),mode:"ios",onIonChange:g},{default:s(()=>[o(e(T),{value:"system"},{default:s(()=>[S("System Notices")]),_:1}),o(e(T),{value:"activities"},{default:s(()=>[S("Activities")]),_:1})]),_:1},8,["modelValue"]),e(l).barLoading||e(r)[c[n.value]].length==0?(f(),w(Z,{key:0,class:"no-data",desc:u.$t("mail.message.nodata")},null,8,["desc"])):(f(),w(e(H),{key:1,style:{"margin-top":"16px"}},{default:s(()=>[n.value=="system"?(f(!0),D(B,{key:0},z(e(r).mailList,a=>(f(),w(e(x),{key:a.detailId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(N),{class:"mail-content"},{default:s(()=>[d("div",ae,m(a.gmtCreate||""),1),d("h4",se,m(a.msgTitle||""),1),d("div",{class:V(["mail-detail",{"show-all":a.showDetail}])},m(a.msgContent||""),3),o(e(v),{class:"ion-justify-content-end"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[o(e(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:I(M=>C(a),["stop"])},{default:s(()=>[d("span",null,m(a.showDetail?"hide":"Show all"),1),o(e(L),{icon:a.showDetail?e(E):e(U),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(v),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[_("",!0)]),_:1}),o(e(p),{size:"auto"},{default:s(()=>[o(e(L),{class:"btn-del",src:e(b)("/icon_userInfo/icon-delete.svg"),onClick:I(M=>P(a),["stop"])},null,8,["src","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):_("",!0),n.value=="activities"?(f(!0),D(B,{key:1},z(e(r).announceList,a=>(f(),w(e(x),{key:a.mainId,class:"mail-item",lines:"none"},{default:s(()=>[o(e(N),{class:"mail-content"},{default:s(()=>[d("div",oe,m(a.startTime||""),1),d("h4",ie,m(a.title||""),1),d("div",{class:V(["mail-detail",{"show-all":a.showDetail}])},m(a.content||""),3),o(e(v),{class:"ion-justify-content-end"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[o(e(A),{class:"btn-show-all",color:"light",fill:"clear",size:"small",onClick:I(M=>C(a),["stop"])},{default:s(()=>[d("span",null,m(a.showDetail?"hide":"Show all"),1),o(e(L),{icon:u.mail.showDetail?e(E):e(U),style:{"margin-left":"4px"}},null,8,["icon"])]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024),o(e(v),{class:"ion-align-items-center ion-justify-content-between"},{default:s(()=>[o(e(p),{size:"auto"},{default:s(()=>[_("",!0)]),_:1}),o(e(p),{size:"auto"})]),_:1})]),_:2},1024)]),_:2},1024))),128)):_("",!0)]),_:1}))]),_:1},512),[[O,!e(l).barLoading]])]),_:1}))}};export{Me as default};
