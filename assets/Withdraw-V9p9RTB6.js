import{D as W,r as _,d as C,j as N,w as l,h as s,y as a,f as e,u as t,v as k,K as f,B as v,a5 as M,S as q,a9 as G,l as X,aa as Q,ab as O,X as Z,t as b,aH as tt,ak as U,al as E,Y as at,x as st,J as z,aI as ot,e as F,q as et,i as nt,F as it,ad as T,M as V,H as A,z as H,a2 as lt,I as rt,a4 as dt,a3 as ct,at as ut,aJ as wt,aK as pt,A as ht,C as mt,s as ft,aC as gt}from"./index-BWYPlUKf.js";import{g as _t,a as vt,c as bt}from"./withdraw-2q59VMUi.js";const At={class:"wrapper"},kt={class:"dialog-title"},$t={class:"dialog-content"},yt={class:"btn-group"},Ct={__name:"SetPasswordPopup",setup(R,{expose:P}){const $=W(),{popupEnter:I,popupLeave:r}=q(),u=_(!1),g=async()=>{u.value=!0},L=()=>{u.value=!1,$.push({name:"WithdrawPassword"})};return P({showDialog:g}),(c,d)=>(C(),N(t(M),{class:"setPassword-popup",isOpen:u.value,enterAnimation:t(I),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[s("div",At,[s("h3",kt,a(c.$t("withdraw.setPasswordPopup.title")),1),s("div",$t,a(c.$t("withdraw.setPasswordPopup.des")),1),s("div",yt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(L,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.goToSetPassword")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},Pt={class:"wrapper"},It={class:"dialog-title"},Lt={class:"dialog-content"},Dt={class:"btn-group"},St={__name:"BankCardPopup",setup(R,{expose:P}){const $=W(),{popupEnter:I,popupLeave:r}=q(),u=_(!1),g=async()=>{u.value=!0},L=()=>{u.value=!1,$.push({name:"BankCardList"})};return P({showDialog:g}),(c,d)=>(C(),N(t(M),{class:"bankCard-popup",isOpen:u.value,enterAnimation:t(I),leaveAnimation:t(r),onDidDismiss:d[1]||(d[1]=D=>u.value=!1)},{default:l(()=>[s("div",Pt,[s("h3",It,a(c.$t("withdraw.bankCardPopup.title")),1),s("div",Lt,a(c.$t("withdraw.bankCardPopup.des")),1),s("div",Dt,[e(t(k),{class:"btn-cancel ion-text-capitalize",fill:"solid",shape:"round",onClick:d[0]||(d[0]=f(D=>u.value=!1,["stop"]))},{default:l(()=>[v(a(c.$t("withdraw.button.cancel")),1)]),_:1}),e(t(k),{class:"btn-confirm ion-text-capitalize",fill:"solid",shape:"round",onClick:f(L,["stop"])},{default:l(()=>[v(a(c.$t("withdraw.button.addNewAccount")),1)]),_:1})])])]),_:1},8,["isOpen","enterAnimation","leaveAnimation"]))}},Nt={class:"balance-card"},Bt={class:"balance-content"},zt={class:"balance-title"},Vt={class:"balance-amount"},Wt={style:{margin:"4px 0"}},Mt={class:"block-title ion-justify-content-between",style:{display:"flex"}},Rt={key:1,class:"bank-info"},Ot={style:{margin:"4px 0"}},Ut={class:"block-title"},Et=s("hr",null,null,-1),Ft={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Tt={slot:"end"},Ht={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},qt={slot:"end"},jt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Jt={slot:"end"},Kt={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},Yt={slot:"end"},xt=s("hr",null,null,-1),Gt={style:{margin:"4px 0"}},Xt={class:"block-title"},Qt={style:{"font-size":"0.8rem"}},Zt={style:{color:"#ffdf3f","margin-left":"4px"}},ta={style:{color:"#ffdf3f","margin-left":"4px"}},aa={class:"account-number"},sa={class:"account-text"},oa=s("br",null,null,-1),ea={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},na={slot:"end"},ia={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},la={slot:"end"},ra={style:{"font-size":"0.8rem",color:"#fa8484"}},da={style:{color:"#ffdf3f",margin:"0 4px"}},ca={style:{margin:"4px 0"}},ua={class:"block-title"},wa={slot:"start",style:{color:"rgb(179, 190, 193)","font-size":"0.8rem"}},pa={slot:"end"},ha={class:"block-title"},_a={__name:"Withdraw",setup(R){const P=at(),{t:$}=G(),I=W(),r=X();Q();const{getPublicUrl:u}=mt(),g=_(null),L=_(null),c=_(!1),d=_(!1),D=_([]),m=CURRENCY_SIGN,y=_(0),S=_(0),i=O({withdrawAmount:0,remainingWithdrawLimit:"",remainingWithdrawCount:"",withdrawLimit:"",vipDailyLimit:"",balance:"",withdrawAccount:{},withdrawAccounts:[]}),w=O({withdrawAmount:0,withdrawFee:0,arrivalAmount:0,bankAccount:"",serviceCharge:0,withdrawPassword:""});Z(async()=>{r.barLoading=!0;const o=await _t();if(o.code==="00000")if(i.withdrawAccounts=o.data,P.query.cardId){const n=i.withdrawAccounts.filter(B=>B.id==P.query.cardId);i.withdrawAccount=n.length>0?n[0]:i.withdrawAccounts[0]}else i.withdrawAccount=i.withdrawAccounts[0];else await(await b.create({message:bankData.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const p=await tt();p.code==="00000"?(d.value=!!p.data.withdrawPasswordValid,d.value||g.value.showDialog()):await(await b.create({message:p.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present();const h=await vt();h.code==="00000"?(S.value=r.appConfig.maxWithdrawAmount,y.value=r.appConfig.minWithdrawAmount,D.value=[y.value],i.withdrawLimit=h.data.withdrawLimit,i.balance=h.data.balance,i.withdrawAmount=y.value):await(await b.create({message:h.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.barLoading=!1});const j=o=>{i.withdrawAmount=Number(o)},J=()=>{d.value?I.push({name:"BankCardList"}):g.value.showDialog()},K=()=>{d.value?I.push({name:"BankCardList"}):g.value.showDialog()},Y=async()=>{if(!d.value){g.value.showDialog();return}if(i.withdrawAccounts.length==0){L.value.showDialog();return}if(Number(i.withdrawAmount)<=0){await(await b.create({message:$("withdraw.toast.text3"),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}if(Number(i.withdrawAmount)<y.value||Number(i.withdrawAmount)>S.value){await(await b.create({message:"Min: ".concat(y.value," Max: ").concat(S.value),duration:1500,position:"top",color:"danger",translucent:!0})).present();return}r.fullLoading=!0,w.arrivalAmount=i.withdrawAmount,w.bankAccount=i.withdrawAccount.cardNo,w.withdrawAmount=i.withdrawAmount,w.withdrawPassword="",c.value=!0,r.fullLoading=!1},x=async()=>{if(w.withdrawPassword.length==0){await(await b.create({message:$("withdraw.toast.text1"),duration:1500,position:"top",color:"warning",translucent:!0})).present();return}r.fullLoading=!0;const o=await bt({amount:Number(i.withdrawAmount),id:i.withdrawAccount.id,memberBankId:i.withdrawAccount.bankId,memberBankCardNo:r.encrypt.encrypt(i.withdrawAccount.cardNo),withdrawPassword:r.encrypt.encrypt(w.withdrawPassword)});o.code==="00000"?(await(await b.create({message:$("withdraw.toast.text2"),duration:1500,position:"top",color:"success",translucent:!0})).present(),c.value=!1):await(await b.create({message:o.msg,duration:1500,position:"top",color:"danger",translucent:!0})).present(),r.fullLoading=!1};return(o,p)=>U((C(),N(t(ht),{class:"withdraw"},{default:l(()=>[e(t(H),null,{default:l(()=>{var h;return[s("div",Nt,[e(t(st),{src:t(u)("/wallet/img-bg-balance.png")},null,8,["src"]),s("div",Bt,[s("div",zt,a(o.$t("withdraw.myBalance")),1),s("div",Vt,a(t(m))+" "+a((h=i.balance)==null?void 0:h.toLocaleString()),1)])]),s("div",Wt,[s("div",Mt,[s("span",null,a(o.$t("withdraw.bankAccount")),1),s("span",{class:"btn-change-account",onClick:f(K,["stop"])},a(o.$t("withdraw.changeBankAccount")),1)]),i.withdrawAccounts.length==0?(C(),N(t(k),{key:0,class:"btn-add-account",expand:"block",onClick:f(J,["stop"])},{default:l(()=>[e(t(z),{slot:"start",icon:t(ot)},null,8,["icon"]),s("span",null,a(o.$t("withdraw.addNewAccount")),1)]),_:1})):(C(),F("div",Rt,"Acc No: "+a(i.withdrawAccount.cardNo),1))]),s("div",Ot,[s("div",Ut,[v(a(o.$t("withdraw.withdrawAmount"))+" ",1),s("span",null,"("+a(t(m))+" "+a(y.value)+" - "+a(S.value)+" )",1)]),e(t(et),{style:{margin:"8px 0"}},{default:l(()=>[(C(!0),F(it,null,nt(D.value,(n,B)=>(C(),N(t(ft),{key:B,size:"3.8",class:gt(["amount-item",{select:Number(n)==Number(i.withdrawAmount)}]),onClick:f(ma=>j(n),["stop"])},{default:l(()=>[s("div",null,a(t(m))+" "+a(n==null?void 0:n.toLocaleString()),1)]),_:2},1032,["class","onClick"]))),128))]),_:1}),e(t(T),{modelValue:i.withdrawAmount,"onUpdate:modelValue":p[0]||(p[0]=n=>i.withdrawAmount=n),label:t(m),type:"number",placeholder:o.$t("withdraw.withdrawAmount"),max:S.value,min:y.value,clearInput:!0},null,8,["modelValue","label","placeholder","max","min"])]),Et,e(t(V),null,{default:l(()=>[e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[s("span",Ft,a(o.$t("withdraw.items1"))+":",1),s("span",Tt,a(t(m))+" "+a(((n=i.remainingWithdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[s("span",Ht,a(o.$t("withdraw.items2"))+":",1),s("span",qt,a(t(m))+" "+a(((n=i.vipDailyLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[s("span",jt,a(o.$t("withdraw.items3"))+":",1),s("span",Jt,a(t(m))+" "+a(((n=i.withdrawLimit)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1}),e(t(A),{class:"limit-item",lines:"none"},{default:l(()=>{var n;return[s("span",Kt,a(o.$t("withdraw.items4"))+":",1),s("span",Yt,a(((n=i.remainingWithdrawCount)==null?void 0:n.toLocaleString())||"-"),1)]}),_:1})]),_:1}),xt,s("div",Gt,[s("div",Xt,a(o.$t("withdraw.tips.title"))+": ",1),s("span",Qt,[s("span",null,a(o.$t("withdraw.tips.tips1")),1),s("span",Zt,a(o.$t("withdraw.tips.tips2")),1),s("span",null,a(o.$t("withdraw.tips.tips3")),1),s("span",ta,a(o.$t("withdraw.tips.tips4")),1),v(". ")])]),U(e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(Y,["stop"])},{default:l(()=>[v(a(o.$t("withdraw.button.withdraw")),1)]),_:1},512),[[E,i.withdrawAmount]])]}),_:1}),e(Ct,{ref_key:"setPasswordPopup",ref:g},null,512),e(St,{ref_key:"bankCardPopup",ref:L},null,512),e(t(M),{class:"withdraw-info","is-open":c.value,"initial-breakpoint":1,breakpoints:[0,1]},{default:l(()=>[e(t(lt),null,{default:l(()=>[e(t(rt),null,{default:l(()=>[e(t(dt),null,{default:l(()=>[v(a(o.$t("withdraw.configPopup.title")),1)]),_:1}),e(t(ct),{style:{position:"absolute",top:"0",right:"16px"}},{default:l(()=>[e(t(k),{onClick:p[1]||(p[1]=f(h=>c.value=!1,["stop"]))},{default:l(()=>[e(t(z),{slot:"icon-only",icon:t(ut),color:"light"},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(t(H),{class:"ion-padding"},{default:l(()=>{var h;return[s("div",aa,a(t(m))+" "+a((h=w.arrivalAmount)==null?void 0:h.toLocaleString()),1),s("div",sa,a(o.$t("withdraw.configPopup.arrivalAmount")),1),oa,e(t(V),null,{default:l(()=>[e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var n;return[s("span",ea,a(o.$t("withdraw.configPopup.title"))+":",1),s("span",na,a(t(m))+" "+a((n=w.withdrawAmount)==null?void 0:n.toLocaleString()),1)]}),_:1}),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>{var n;return[s("span",ia,a(o.$t("withdraw.configPopup.serviceCharge"))+":",1),s("span",la,a(t(m))+" "+a((n=w.serviceCharge)==null?void 0:n.toLocaleString()),1)]}),_:1}),s("div",ra,[s("span",null,a(o.$t("withdraw.configPopup.des1")),1),s("span",da,a(w.withdrawFee)+"%",1),s("span",null,a(o.$t("withdraw.configPopup.des2")),1)]),s("div",ca,[s("div",ua,a(o.$t("withdraw.configPopup.chooseBankAccount")),1),e(t(A),{class:"detail-item",lines:"none"},{default:l(()=>[s("span",wa,a(o.$t("withdraw.configPopup.yourBankAccount"))+":",1),s("span",pa,a(w.bankAccount),1)]),_:1})])]),_:1}),e(t(V),{class:"password-info",lines:"none",style:{margin:"4px 0"}},{default:l(()=>[s("div",ha,a(o.$t("withdraw.configPopup.withdrawPassword")),1),e(t(A),null,{default:l(()=>[e(t(T),{modelValue:w.withdrawPassword,"onUpdate:modelValue":p[2]||(p[2]=n=>w.withdrawPassword=n),type:"password",fill:"outline",placeholder:o.$t("withdraw.configPopup.placeHolder")},{default:l(()=>[e(t(z),{slot:"start",icon:t(wt)},null,8,["icon"]),e(t(pt),{slot:"end",color:"medium"})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1}),e(t(k),{class:"btn-withdraw",expand:"block",shape:"round",onClick:f(x,["stop"])},{default:l(()=>[v(a(o.$t("withdraw.button.withdraw")),1)]),_:1})]}),_:1})]),_:1},8,["is-open"])]),_:1},512)),[[E,!t(r).barLoading]])}};export{_a as default};
